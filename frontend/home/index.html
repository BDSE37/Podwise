<!DOCTYPE HTML>

<html>

<head>
	<title>PodWise Podcastè‡ªå‹•æ‘˜è¦èˆ‡å€‹äººåŒ–æ¨è–¦ç³»çµ±</title>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
	<link rel="stylesheet" href="assets/css/main.css" />

	<style>
		/* â€”â€” Step 4ï¼šäº‚ç¢¼é¡¯ç¤ºèˆ‡è¤‡è£½ â€”â€” */
		#popup-step-4 {
			display: none;
			text-align: left;
		}

		#popup-step-4 h2 {
			color: #583e3d;
			font-size: 1.8em;
			margin-bottom: 1em;
		}

		#popup-step-4 .code-block-container {
			display: flex;
			align-items: flex-start;
			gap: 8px;
			margin-bottom: 1.5em;
		}

		#popup-step-4 pre#generated-code {
			background: #f5f5f5;
			padding: 1em;
			border-radius: 4px;
			font-family: monospace;
			font-size: 0.9em;
			white-space: pre-wrap;
			word-break: break-all;
			flex: 1;
			max-height: 150px;
			overflow: auto;
			border: 1px solid rgba(210, 215, 217, 0.75);
		}

		#popup-step-4 button#copy-code-btn {
			background-color: #d7b590;
			color: #fff;
			border: none;
			border-radius: 4px;
			padding: 0.6em 1.2em;
			font-size: 0.9em;
			cursor: pointer;
			transition: transform 0.1s ease;
		}

		#popup-step-4 button#copy-code-btn:active {
			transform: scale(0.95);
		}
		.music-cards {
			display: flex;
			gap: 2em;
			margin-top: 2em;
		}
		.music-card {
			background: #ebebeb;
			border-radius: 1em;
			box-shadow: 0 4px 16px rgba(88,62,61,0.08);
			width: 220px;
			overflow: hidden;
			transition: box-shadow 0.2s;
		}
		.music-card:hover {
			box-shadow: 0 8px 24px rgba(88,62,61,0.18);
		}
		.music-card-img {
			position: relative;
			width: 100%;
			height: 180px;
			overflow: hidden;
		}
		.music-card-img img {
			width: 100%;
			height: 100%;
			object-fit: cover;
		}
		.play-btn {
			position: absolute;
			bottom: 12px;
			right: 12px;
			background: rgba(215,181,144,0.9);
			border: none;
			border-radius: 50%;
			width: 44px;
			height: 44px;
			font-size: 1.5em;
			color: #fff;
			cursor: pointer;
			box-shadow: 0 2px 8px rgba(88,62,61,0.15);
			transition: background 0.2s;
		}
		.play-btn:hover {
			background: #583e3d;
		}
		.music-card-info {
			padding: 1em;
			text-align: left;
		}
		.music-card-title {
			font-weight: bold;
			font-size: 1.1em;
			color: #583e3d;
		}
		.music-card-author {
			color: #a08c7d;
			font-size: 0.95em;
			margin-top: 0.3em;
		}
		header.major {
			text-align: center;
		}
		.music-cards,
		.quiz-recommendations {
			display: flex;
			justify-content: center;
			align-items: flex-start;
			gap: 2em;
			flex-wrap: wrap;
		}

		header.major h2 { 
  color: inherit; 
}

/* åªæŠŠå‰é¢çš„ dash è¨­ç‚ºç™½è‰² */
header.major .dash {
  color: #fff;
}

.searchbar-row {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 16px; /* æ§åˆ¶é–“è·ï¼Œå¯èª¿æ•´ */
  width: 100%;
  margin-top: 1em;
}

.InputContainer {
  display: flex;
  align-items: center;
  /* å…¶ä»–åŸæœ‰æ¨£å¼ä¸è®Š */
}

.input-logo {
  height: 38px;
  width: 38px;
  cursor: pointer;
  transition: filter 0.2s;
  vertical-align: middle;
}
.input-logo:hover {
  filter: brightness(0.8);
}

/* æ–°å¢ TAG æŒ‰éˆ•æ¨£å¼ï¼šé€™è£¡åªä¿ç•™ç´” CSSï¼Œä¸è¦æœ‰ JS */
	</style>
</head>

<body class="is-preload">

	<!-- Wrapper -->
	<div id="wrapper">

		<!-- Main -->
		<div id="main">
			<div class="inner">

				<!-- Header -->
				<header id="header" style="display: flex; justify-content: space-between; align-items: center; 
				padding: 10px 30px; width: 100%; box-sizing: border-box; margin-top: 40px;margin-bottom: 60px;">
				<!-- å·¦å´ï¼šlogo + æ–‡å­— -->
				<a href="podri.html" class="logo" style="display: flex; align-items: center; text-decoration: none;">
				  <img src="images/logo_black.png" alt="PodWise Logo" style="height: 60px; margin-right: 10px;">
				  <strong>PodWise</strong> Podcastè‡ªå‹•æ‘˜è¦èˆ‡å€‹äººåŒ–æ¨è–¦ç³»çµ±
				</a>
				<!-- å³å´ï¼šä½¿ç”¨è€…é ­åƒ -->
				<div>
				  <img src="images/user.png" id="user-login-btn" alt="ç™»å…¥"
					style="width:40px; height:40px; cursor:pointer; border-radius:50%; border:2px solid #1dd195; background:#fff; box-shadow:0 2px 8px rgba(0,0,0,0.08);">
				</div>
				<!-- ç™»å…¥å½ˆçª— -->
				<div id="login-modal" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.18); z-index:9999;">
					<div style="position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); background:#fff; border-radius:16px; box-shadow:0 8px 32px rgba(0,0,0,0.18); padding:2em 2.5em; min-width:260px;">
						<div style="text-align:center; margin-bottom:1em; font-weight:bold; font-size:1.1em;">è«‹è¼¸å…¥ä½¿ç”¨è€…ID</div>
						<input type="text" id="user-id-input" placeholder="TYPE YOUR ID" style="width:100%; padding:0.7em; border-radius:8px; border:1px solid #1dd195; margin-bottom:1em; text-align:center; font-size:1em;">
						<div id="login-close-btn" style="position:absolute; top:10px; right:14px; font-size:1.3em; color:#aaa; cursor:pointer;">&times;</div>
					</div>
				</div>
					<!-- <ul class="icons">
						<li><a href="#" class="icon brands fa-twitter"><span class="label">Twitter</span></a></li>
						<li><a href="#" class="icon brands fa-facebook-f"><span class="label">Facebook</span></a></li>
						<li><a href="#" class="icon brands fa-snapchat-ghost"><span class="label">Snapchat</span></a>
						</li>
						<li><a href="#" class="icon brands fa-instagram"><span class="label">Instagram</span></a></li>
						<li><a href="#" class="icon brands fa-medium-m"><span class="label">Medium</span></a></li>
					</ul> -->
				</header>

				<!-- Banner -->
				<section id="banner">
					<div class="content">
						<header>
							<h1>PodWise<br /></h1>
							<h2>AI ç²¾æº–èª¿é »ï¼Œæ‰“é€ ä½ çš„å€‹äººè²éŸ³ç©ºé–“ã€‚</h2>
							<p> PodWiseå¸Œæœ›æˆç‚ºä½ çš„æ™ºèƒ½åš®å°,å¹«åŠ©ä½ ç™¼ç¾ç¬¦åˆä½ è†è½ç¿’æ…£çš„å°ˆå±¬ç²¾å½©å…§å®¹ã€‚</p>
							<p>è®“æ¯ä¸€æ¬¡æ”¶è½,éƒ½æ›´è²¼è¿‘ä½ çš„éœ€æ±‚ã€‚
							</p>
						</header>
<!-- æœå°‹æ¬„ç½®ä¸­å¤–å±¤ -->
<div class="searchbar-row">
  <div class="InputContainer">
    <input placeholder="Ask Podri.." id="input" class="input" name="text" type="text">
  </div>
</div>

<script>
// æœå°‹æ¬„ Enter éµè·³è½‰åŠŸèƒ½
document.addEventListener('DOMContentLoaded', function() {
    const searchInput = document.getElementById('input');
    
    if (searchInput) {
        searchInput.addEventListener('keypress', function(event) {
            if (event.key === 'Enter') {
                const searchText = this.value.trim();
                if (searchText) {
                    // è·³è½‰åˆ° podri.html ä¸¦å¸¶å…¥æœå°‹æ–‡å­—åƒæ•¸
                    window.location.href = `podri.html?search=${encodeURIComponent(searchText)}`;
                }
            }
        });
    }
});
// ç™»å…¥å½ˆçª—äº’å‹•
(function(){
	const loginBtn = document.getElementById('user-login-btn');
	const loginModal = document.getElementById('login-modal');
	const closeBtn = document.getElementById('login-close-btn');
	const userIdInput = document.getElementById('user-id-input');

	if(loginBtn && loginModal) {
		loginBtn.onclick = function(e) {
			loginModal.style.display = 'block';
			userIdInput.value = '';
			userIdInput.focus();
			e.stopPropagation();
		};
	}
	if(closeBtn && loginModal) {
		closeBtn.onclick = function() {
			loginModal.style.display = 'none';
		};
	}
	if(loginModal) {
		loginModal.onclick = function(e) {
			if(e.target === loginModal) loginModal.style.display = 'none';
		};
	}
	if(userIdInput) {
		userIdInput.addEventListener('keydown', function(e){
			if(e.key === 'Enter') {
				alert('å·²è¼¸å…¥IDï¼š' + userIdInput.value);
				loginModal.style.display = 'none';
			}
		});
	}
})();
</script>


				<!-- Section -->
				<section>
					<header class="major">
						<h2 style="margin-top:6em; text-align:center;">
						  <span class="dash">--</span>ç†±é–€æ¨è–¦
						</h2>
					  </header>
					  
					<div class="music-cards">
						<!-- å¡ç‰‡1 -->
<div class="card">
	<div class="one">
	  <div class="music">
		<svg
		  viewBox="0 0 16 16"
		  class="note bi bi-music-note"
		  fill="currentColor"
		  height="18"
		  width="18"
		  xmlns="http://www.w3.org/2000/svg"
		>
		  <path
			d="M9 13c0 1.105-1.12 2-2.5 2S4 14.105 4 13s1.12-2 2.5-2 2.5.895 2.5 2z"
		  ></path>
		  <path d="M9 3v10H8V3h1z" fill-rule="evenodd"></path>
		  <path
			d="M8 2.82a1 1 0 0 1 .804-.98l3-.6A1 1 0 0 1 13 2.22V4L8 5V2.82z"
		  ></path>
		</svg>
	  </div>
	  <span class="name"
		><div></div>
		One piece first ending</span
	  >
	  <span class="name1"
		><div></div>
		Desconhecido</span
	  >
	  <div class="bar">
		<svg
		  viewBox="0 0 16 16"
		  class="color bi bi-fast-forward-fill"
		  fill="currentColor"
		  height="16"
		  width="16"
		  xmlns="http://www.w3.org/2000/svg"
		>
		  <path
			d="M7.596 7.304a.802.802 0 0 1 0 1.392l-6.363 3.692C.713 12.69 0 12.345 0 11.692V4.308c0-.653.713-.998 1.233-.696l6.363 3.692Z"
		  ></path>
		  <path
			d="M15.596 7.304a.802.802 0 0 1 0 1.392l-6.363 3.692C8.713 12.69 8 12.345 8 11.692V4.308c0-.653.713-.998 1.233-.696l6.363 3.692Z"
		  ></path>
		</svg>
		<svg
		  viewBox="0 0 16 16"
		  class="color bi bi-caret-right-fill"
		  fill="currentColor"
		  height="18"
		  width="18"
		  xmlns="http://www.w3.org/2000/svg"
		>
		  <path
			d="m12.14 8.753-5.482 4.796c-.646.566-1.658.106-1.658-.753V3.204a1 1 0 0 1 1.659-.753l5.48 4.796a1 1 0 0 1 0 1.506z"
		  ></path>
		</svg>
		<svg
		  viewBox="0 0 16 16"
		  class="color bi bi-fast-forward-fill"
		  fill="currentColor"
		  height="16"
		  width="16"
		  xmlns="http://www.w3.org/2000/svg"
		>
		  <path
			d="M7.596 7.304a.802.802 0 0 1 0 1.392l-6.363 3.692C.713 12.69 0 12.345 0 11.692V4.308c0-.653.713-.998 1.233-.696l6.363 3.692Z"
		  ></path>
		  <path
			d="M15.596 7.304a.802.802 0 0 1 0 1.392l-6.363 3.692C8.713 12.69 8 12.345 8 11.692V4.308c0-.653.713-.998 1.233-.696l6.363 3.692Z"
		  ></path>
		</svg>
	  </div>

	</div>
	<div class="two"></div>
	<div class="three"></div>
  </div>
						<!-- å¡ç‰‡2 -->
						<div class="card">
							<div class="one">
							  <div class="music">
								<svg
								  viewBox="0 0 16 16"
								  class="note bi bi-music-note"
								  fill="currentColor"
								  height="18"
								  width="18"
								  xmlns="http://www.w3.org/2000/svg"
								>
								  <path
									d="M9 13c0 1.105-1.12 2-2.5 2S4 14.105 4 13s1.12-2 2.5-2 2.5.895 2.5 2z"
								  ></path>
								  <path d="M9 3v10H8V3h1z" fill-rule="evenodd"></path>
								  <path
									d="M8 2.82a1 1 0 0 1 .804-.98l3-.6A1 1 0 0 1 13 2.22V4L8 5V2.82z"
								  ></path>
								</svg>
							  </div>
							  <span class="name"
								><div></div>
								One piece first ending</span
							  >
							  <span class="name1"
								><div></div>
								Desconhecido</span
							  >
							  <div class="bar">
								<svg
								  viewBox="0 0 16 16"
								  class="color bi bi-fast-forward-fill"
								  fill="currentColor"
								  height="16"
								  width="16"
								  xmlns="http://www.w3.org/2000/svg"
								>
								  <path
									d="M7.596 7.304a.802.802 0 0 1 0 1.392l-6.363 3.692C.713 12.69 0 12.345 0 11.692V4.308c0-.653.713-.998 1.233-.696l6.363 3.692Z"
								  ></path>
								  <path
									d="M15.596 7.304a.802.802 0 0 1 0 1.392l-6.363 3.692C8.713 12.69 8 12.345 8 11.692V4.308c0-.653.713-.998 1.233-.696l6.363 3.692Z"
								  ></path>
								</svg>
								<svg
								  viewBox="0 0 16 16"
								  class="color bi bi-caret-right-fill"
								  fill="currentColor"
								  height="18"
								  width="18"
								  xmlns="http://www.w3.org/2000/svg"
								>
								  <path
									d="m12.14 8.753-5.482 4.796c-.646.566-1.658.106-1.658-.753V3.204a1 1 0 0 1 1.659-.753l5.48 4.796a1 1 0 0 1 0 1.506z"
								  ></path>
								</svg>
								<svg
								  viewBox="0 0 16 16"
								  class="color bi bi-fast-forward-fill"
								  fill="currentColor"
								  height="16"
								  width="16"
								  xmlns="http://www.w3.org/2000/svg"
								>
								  <path
									d="M7.596 7.304a.802.802 0 0 1 0 1.392l-6.363 3.692C.713 12.69 0 12.345 0 11.692V4.308c0-.653.713-.998 1.233-.696l6.363 3.692Z"
								  ></path>
								  <path
									d="M15.596 7.304a.802.802 0 0 1 0 1.392l-6.363 3.692C8.713 12.69 8 12.345 8 11.692V4.308c0-.653.713-.998 1.233-.696l6.363 3.692Z"
								  ></path>
								</svg>
							  </div>
						
							</div>
							<div class="two"></div>
							<div class="three"></div>
						  </div>
<!-- å¡ç‰‡2 -->
						<div class="card">
							<div class="one">
							  <div class="music">
								<svg
								  viewBox="0 0 16 16"
								  class="note bi bi-music-note"
								  fill="currentColor"
								  height="18"
								  width="18"
								  xmlns="http://www.w3.org/2000/svg"
								>
								  <path
									d="M9 13c0 1.105-1.12 2-2.5 2S4 14.105 4 13s1.12-2 2.5-2 2.5.895 2.5 2z"
								  ></path>
								  <path d="M9 3v10H8V3h1z" fill-rule="evenodd"></path>
								  <path
									d="M8 2.82a1 1 0 0 1 .804-.98l3-.6A1 1 0 0 1 13 2.22V4L8 5V2.82z"
								  ></path>
								</svg>
							  </div>
							  <span class="name"
								><div></div>
								One piece first ending</span
							  >
							  <span class="name1"
								><div></div>
								Desconhecido</span
							  >
							  <div class="bar">
								<svg
								  viewBox="0 0 16 16"
								  class="color bi bi-fast-forward-fill"
								  fill="currentColor"
								  height="16"
								  width="16"
								  xmlns="http://www.w3.org/2000/svg"
								>
								  <path
									d="M7.596 7.304a.802.802 0 0 1 0 1.392l-6.363 3.692C.713 12.69 0 12.345 0 11.692V4.308c0-.653.713-.998 1.233-.696l6.363 3.692Z"
								  ></path>
								  <path
									d="M15.596 7.304a.802.802 0 0 1 0 1.392l-6.363 3.692C8.713 12.69 8 12.345 8 11.692V4.308c0-.653.713-.998 1.233-.696l6.363 3.692Z"
								  ></path>
								</svg>
								<svg
								  viewBox="0 0 16 16"
								  class="color bi bi-caret-right-fill"
								  fill="currentColor"
								  height="18"
								  width="18"
								  xmlns="http://www.w3.org/2000/svg"
								>
								  <path
									d="m12.14 8.753-5.482 4.796c-.646.566-1.658.106-1.658-.753V3.204a1 1 0 0 1 1.659-.753l5.48 4.796a1 1 0 0 1 0 1.506z"
								  ></path>
								</svg>
								<svg
								  viewBox="0 0 16 16"
								  class="color bi bi-fast-forward-fill"
								  fill="currentColor"
								  height="16"
								  width="16"
								  xmlns="http://www.w3.org/2000/svg"
								>
								  <path
									d="M7.596 7.304a.802.802 0 0 1 0 1.392l-6.363 3.692C.713 12.69 0 12.345 0 11.692V4.308c0-.653.713-.998 1.233-.696l6.363 3.692Z"
								  ></path>
								  <path
									d="M15.596 7.304a.802.802 0 0 1 0 1.392l-6.363 3.692C8.713 12.69 8 12.345 8 11.692V4.308c0-.653.713-.998 1.233-.696l6.363 3.692Z"
								  ></path>
								</svg>
							  </div>
						
							</div>
							<div class="two"></div>
							<div class="three"></div>
						  </div>
<!-- å¡ç‰‡2 -->
						<div class="card">
							<div class="one">
							  <div class="music">
								<svg
								  viewBox="0 0 16 16"
								  class="note bi bi-music-note"
								  fill="currentColor"
								  height="18"
								  width="18"
								  xmlns="http://www.w3.org/2000/svg"
								>
								  <path
									d="M9 13c0 1.105-1.12 2-2.5 2S4 14.105 4 13s1.12-2 2.5-2 2.5.895 2.5 2z"
								  ></path>
								  <path d="M9 3v10H8V3h1z" fill-rule="evenodd"></path>
								  <path
									d="M8 2.82a1 1 0 0 1 .804-.98l3-.6A1 1 0 0 1 13 2.22V4L8 5V2.82z"
								  ></path>
								</svg>
							  </div>
							  <span class="name"
								><div></div>
								One piece first ending</span
							  >
							  <span class="name1"
								><div></div>
								Desconhecido</span
							  >
							  <div class="bar">
								<svg
								  viewBox="0 0 16 16"
								  class="color bi bi-fast-forward-fill"
								  fill="currentColor"
								  height="16"
								  width="16"
								  xmlns="http://www.w3.org/2000/svg"
								>
								  <path
									d="M7.596 7.304a.802.802 0 0 1 0 1.392l-6.363 3.692C.713 12.69 0 12.345 0 11.692V4.308c0-.653.713-.998 1.233-.696l6.363 3.692Z"
								  ></path>
								  <path
									d="M15.596 7.304a.802.802 0 0 1 0 1.392l-6.363 3.692C8.713 12.69 8 12.345 8 11.692V4.308c0-.653.713-.998 1.233-.696l6.363 3.692Z"
								  ></path>
								</svg>
								<svg
								  viewBox="0 0 16 16"
								  class="color bi bi-caret-right-fill"
								  fill="currentColor"
								  height="18"
								  width="18"
								  xmlns="http://www.w3.org/2000/svg"
								>
								  <path
									d="m12.14 8.753-5.482 4.796c-.646.566-1.658.106-1.658-.753V3.204a1 1 0 0 1 1.659-.753l5.48 4.796a1 1 0 0 1 0 1.506z"
								  ></path>
								</svg>
								<svg
								  viewBox="0 0 16 16"
								  class="color bi bi-fast-forward-fill"
								  fill="currentColor"
								  height="16"
								  width="16"
								  xmlns="http://www.w3.org/2000/svg"
								>
								  <path
									d="M7.596 7.304a.802.802 0 0 1 0 1.392l-6.363 3.692C.713 12.69 0 12.345 0 11.692V4.308c0-.653.713-.998 1.233-.696l6.363 3.692Z"
								  ></path>
								  <path
									d="M15.596 7.304a.802.802 0 0 1 0 1.392l-6.363 3.692C8.713 12.69 8 12.345 8 11.692V4.308c0-.653.713-.998 1.233-.696l6.363 3.692Z"
								  ></path>
								</svg>
							  </div>
						
							</div>
							<div class="two"></div>
							<div class="three"></div>
						  </div>

					</div>
					<audio id="audio-player"></audio>
				</section>
			</div>
		</div>
		<!--sidebay-->
	</div>
	
	<!-- Scripts -->
	<script>
		window.addEventListener('DOMContentLoaded', () => {
			// ç¬¬ä¸€æ¬¡é€ è¨ªæ‰é¡¯ç¤º popup
			const hasVisited = localStorage.getItem('hasVisitedPopup');

			if (!hasVisited) {
				document.getElementById('popup-overlay').style.display = 'flex';
				localStorage.setItem('hasVisitedPopup', 'true');
			}
		});

		function closePopup() {
			document.getElementById("popup-overlay").style.display = "none";
		}
	</script>

	<script src="assets/js/jquery.min.js"></script>
	<script src="assets/js/browser.min.js"></script>
	<script src="assets/js/breakpoints.min.js"></script>
	<script src="assets/js/util.js"></script>
	<script src="assets/js/main.js"></script>

	<!-- Quiz Overlay -->
	<div id="popup-overlay"
		style="display: none; position: fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.6); z-index:9999; display:flex; justify-content:center; align-items:center;">
		<div id="popup-container"
			style="background:#ebebeb; padding:2.5em; border-radius:2em; max-width:600px; width:90%; position:relative;">
			<!-- é—œé–‰æŒ‰éˆ• -->
			<img src="images/delete.png" alt="é—œé–‰" class="close-button"
				style="position:absolute; top:1rem; right:1rem; width:24px; height:24px; cursor:pointer; z-index:10;"
				onclick="closePopup()">
			<!-- Step 1 -->
			<div class="popup-step" id="popup-step-1">
				<h2>Taste of PodWise !</h2>
				<div class="quiz-option-container">
					<div class="quiz-option" onclick="selectMainCategory('business')">
						<img src="images/financial-profit_golden.png" alt="å•†æ¥­">
						<div>å•†æ¥­</div>
					</div>
					<div class="quiz-option" onclick="selectMainCategory('education')">
						<img src="images/school_golden.png" alt="æ•™è‚²">
						<div>æ•™è‚²</div>
					</div>
				</div>
			</div>

			<!-- Step 2 -->
			<div class="popup-step" id="popup-step-2" style="display:none;">
				<h2>Which type?</h2>
				<div id="category-tags" style="display: flex; gap: 1em; margin-bottom: 1.5em;"></div>
				<div class="quiz-type-container">
					<button class="quiz-type-btn" onclick="selectCategory(this, 'è²¡ç¶“')">è²¡ç¶“</button>
					<button class="quiz-type-btn" onclick="selectCategory(this, 'è·æ¥­')">è·æ¥­</button>
					<button class="quiz-type-btn" onclick="selectCategory(this, 'æˆ¿åœ°ç”¢')">æˆ¿åœ°ç”¢</button>
					<button class="quiz-type-btn" onclick="selectCategory(this, 'è¡ŒéŠ·')">è¡ŒéŠ·</button>
					<button class="quiz-type-btn" onclick="selectCategory(this, 'æ•™è‚²')">æ•™è‚²</button>
					<button class="quiz-type-btn" onclick="selectCategory(this, 'å­¸ç¿’')">å­¸ç¿’</button>
					<button class="quiz-type-btn" onclick="selectCategory(this, 'çŸ¥è­˜')">çŸ¥è­˜</button>
					<button class="quiz-type-btn" onclick="selectCategory(this, 'æŠ€èƒ½')">æŠ€èƒ½</button>
				</div>
				<button class="button primary" style="margin-top:2em;" onclick="goToStep(3)">ä¸‹ä¸€æ­¥</button>
			</div>
			
			<script>
				let mainCategory = '';
				
				function selectMainCategory(category) {
					mainCategory = category;
					goToStep(2);
				}
				
				function selectCategory(button, category) {
					// ç§»é™¤æ‰€æœ‰æŒ‰éˆ•çš„é¸ä¸­ç‹€æ…‹
					document.querySelectorAll('.quiz-type-btn').forEach(btn => {
						btn.classList.remove('selected');
					});
					
					// æ·»åŠ é¸ä¸­ç‹€æ…‹åˆ°ç•¶å‰æŒ‰éˆ•
					button.classList.add('selected');
					
					// å„²å­˜é¸ä¸­çš„é¡åˆ¥
					window.selectedCategory = category;
					window.selectedTag = null; // åˆ‡æ›ä¸»é¡åˆ¥æ™‚æ¸…ç©ºå·²é¸ TAG
					renderCategoryTags(); // é‡æ–°æ¸²æŸ“ TAGs
				}
				
				// åœ¨ goToStep å‡½æ•¸ä¸­æ·»åŠ é¡¯ç¤ºå°æ‡‰é¸é …çš„é‚è¼¯
				function goToStep(step) {
					// éš±è—æ‰€æœ‰æ­¥é©Ÿ
					document.querySelectorAll('.popup-step').forEach(s => s.style.display = 'none');
					
					// é¡¯ç¤ºæŒ‡å®šæ­¥é©Ÿ
					document.getElementById(`popup-step-${step}`).style.display = 'block';
					
					// å¦‚æœæ˜¯ Step 2ï¼Œæ¸²æŸ“ TAGs
					if (step === 2) {
						renderCategoryTags();
					}
					
					// å¦‚æœæ˜¯ Step 3ï¼Œè¼‰å…¥æ¨è–¦
					if (step === 3) {
						loadRecommendations();
					}
				}
			</script>

<!-- Step 3 -->
<div class="popup-step" id="popup-step-3" style="display:none;">
	<h2>You may likeâ€¦</h2>
	<h3 style="text-align:left; margin-left:0; padding-left:0;">
	  è©¦è½ä½ æœ‰èˆˆè¶£çš„ç¯€ç›® ä¸¦æŒ‰ä¸‹å–œæ­¡
	</h3>
	<div class="quiz-recommendations" id="recommendations-container" style="display: flex; gap: 1.5em; flex-wrap: wrap; justify-content: center; align-items: center;">
	  <!-- æ¨è–¦ç¯€ç›®å°‡åœ¨é€™è£¡å‹•æ…‹è¼‰å…¥ -->
	  </div>
  
	<button class="button secondary" onclick="refreshRecommendations()">é‡æ–°æ•´ç†</button>
	<button class="button primary" onclick="goToStep(4)">ä¸‹ä¸€æ­¥</button>
  
	<script>
	  // å…¨åŸŸè®Šæ•¸
	  let currentCategory = '';
	  let selectedEpisodes = [];
	  let currentRecommendations = [];
	  
	  // ä¸»é¡åˆ¥å°æ‡‰ TAG poolï¼ˆèˆ‡å¾Œç«¯ä¸€è‡´ï¼‰
	  const CATEGORY_TAGS = {
		business: ["æŠ•è³‡ç†è²¡", "è‚¡ç¥¨åˆ†æ", "æˆ¿åœ°ç”¢", "å‰µæ¥­"],
		education: ["å­¸ç¿’æ–¹æ³•", "æ•™è‚²ç†å¿µ", "çŸ¥è­˜åˆ†äº«", "å€‹äººæˆé•·"]
	  };
	  
	  window.selectedTag = null;
	  
	  // æ¸²æŸ“ Step 2 çš„ TAG æŒ‰éˆ•
	  function renderCategoryTags() {
		const tagDiv = document.getElementById('category-tags');
		tagDiv.innerHTML = '';
		const apiCategory = mapCategoryToAPI(getCategoryFromStep2());
		const tags = CATEGORY_TAGS[apiCategory] || [];
		tags.forEach(tag => {
		  const btn = document.createElement('button');
		  btn.className = 'tag-btn' + (window.selectedTag === tag ? ' selected' : '');
		  btn.textContent = tag;
		  btn.onclick = function() {
			window.selectedTag = tag;
			renderCategoryTags(); // é‡æ–°æ¸²æŸ“é«˜äº®
		  };
		  tagDiv.appendChild(btn);
		});
	  }
	  
	  // å¾ Step 2 ç²å–é¡åˆ¥
	  function getCategoryFromStep2() {
		// é¦–å…ˆæª¢æŸ¥å…¨åŸŸè®Šæ•¸
		if (window.selectedCategory) {
		  console.log('ä½¿ç”¨å…¨åŸŸè®Šæ•¸ selectedCategory:', window.selectedCategory);
		  return window.selectedCategory;
		}
		
		// å¦‚æœå…¨åŸŸè®Šæ•¸æ²’æœ‰ï¼Œå‰‡æª¢æŸ¥ DOM
		const categoryButtons = document.querySelectorAll('.quiz-type-btn');
		for (let btn of categoryButtons) {
		  if (btn.classList.contains('selected')) {
			const category = btn.textContent.trim();
			console.log('å¾ DOM ç²å–é¡åˆ¥:', category);
			return category;
		  }
		}
		console.log('æ²’æœ‰æ‰¾åˆ°é¸ä¸­çš„é¡åˆ¥ï¼Œä½¿ç”¨é è¨­å€¼: business');
		return 'business'; // é è¨­å€¼
	  }
	  
	  // æ˜ å°„é¡åˆ¥åˆ° API é¡åˆ¥
	  function mapCategoryToAPI(category) {
		const categoryMap = {
		  'è²¡ç¶“': 'business',
		  'è·æ¥­': 'business', 
		  'æˆ¿åœ°ç”¢': 'business',
		  'è¡ŒéŠ·': 'business',
		  'æŠ•è³‡': 'business',
		  'ç†è²¡': 'business',
		  'æ•™è‚²': 'education',
		  'å­¸ç¿’': 'education',
		  'çŸ¥è­˜': 'education',
		  'æŠ€èƒ½': 'education'
		};
		return categoryMap[category] || 'business';
	  }
	  
	  // è¼‰å…¥æ¨è–¦ç¯€ç›®
	  async function loadRecommendations() {
		try {
		  currentCategory = getCategoryFromStep2();
		  const apiCategory = mapCategoryToAPI(currentCategory);
		  const tag = window.selectedTag;
		  const response = await fetch('http://localhost:8006/api/category/recommendations', {
			method: 'POST',
			headers: { 'Content-Type': 'application/json' },
			body: JSON.stringify({ category: apiCategory, tag: tag })
		  });
		  if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
		  const data = await response.json();
		  currentRecommendations = data.recommendations || [];
		  renderRecommendations();
		} catch (error) {
		  console.error('è¼‰å…¥æ¨è–¦å¤±æ•—:', error);
		  loadDefaultRecommendations();
		}
	  }
	  
	  // è¼‰å…¥é è¨­æ¨è–¦ï¼ˆç•¶ API ä¸å¯ç”¨æ™‚ï¼‰
	  function loadDefaultRecommendations() {
		const defaultRecommendations = [
		  {
			podcast_name: 'è‚¡ç™Œ Gooaye',
			episode_title: 'æŠ•è³‡ç†è²¡ç²¾é¸',
			episode_description: 'æ™¦æ¾€é‡‘èæŠ•è³‡çŸ¥è­˜ç›´ç™½è¬›ï¼Œé‡è¦æµ·å…§å¤–æ™‚äº‹è¼•é¬†è«‡ã€‚',
			podcast_image: 'images/è‚¡ç™Œ.png',
			audio_url: 'audio/sample1.mp3',
			episode_id: 1,
			rss_id: '123',
			tags: ['æŠ•è³‡ç†è²¡', 'è‚¡ç¥¨åˆ†æ', 'å¸‚å ´è¶¨å‹¢', 'ç¶“æ¿Ÿåˆ†æ']
		  },
		  {
			podcast_name: 'çŸ½è°·è¼•é¬†è«‡',
			episode_title: 'AI æŠ€è¡“è¶¨å‹¢',
			episode_description: 'Google æœå°‹ã€AI æŠ€è¡“ã€ç§‘æŠ€è¶¨å‹¢éƒ½èƒ½è¼•é¬†è½æ‡‚ã€‚',
			podcast_image: 'images/çŸ½è°·è¼•é¬†è«‡.png',
			audio_url: 'audio/sample2.mp3',
			episode_id: 2,
			rss_id: '456',
			tags: ['ç§‘æŠ€è¶¨å‹¢', 'äººå·¥æ™ºæ…§', 'å‰µæ–°æ€ç¶­', 'æ•¸ä½è½‰å‹']
		  },
		  {
			podcast_name: 'å¤©ä¸‹å­¸ç¿’',
			episode_title: 'ç®¡ç†æ€ç¶­åˆ†äº«',
			episode_description: 'è¨ªè«‡é ‚å°–é ˜å°è€…ï¼Œæ¢ç´¢ç®¡ç†æ€ç¶­ã€æ•™è‚²å‰µæ–°èˆ‡æœªä¾†è¶¨å‹¢ã€‚',
			podcast_image: 'images/å¤©ä¸‹å­¸ç¿’.png',
			audio_url: 'audio/sample3.mp3',
			episode_id: 3,
			rss_id: '789',
			tags: ['ä¼æ¥­ç®¡ç†', 'é ˜å°åŠ›', 'å­¸ç¿’æ–¹æ³•', 'å€‹äººæˆé•·']
		  }
		];
  
		currentRecommendations = defaultRecommendations;
		renderRecommendations();
	  }
	  
	  // æ¸²æŸ“æ¨è–¦ç¯€ç›®
	  function renderRecommendations() {
		const container = document.getElementById('recommendations-container');
		container.innerHTML = '';
  
		currentRecommendations.forEach((rec, index) => {
		  const rssId = rec.rss_id;
		  const playBtnId = `play-btn-${index}`;
		  const imgId = `podcast-img-${index}`;
		  
		  // èª¿è©¦ï¼šæª¢æŸ¥æ¯å€‹æ¨è–¦çš„ tags
		  console.log(`æ¸²æŸ“æ¨è–¦ ${index + 1}:`, {
			rec_tags: rec.tags,
			rec_tags_type: typeof rec.tags,
			rec_tags_length: rec.tags ? rec.tags.length : 0,
			tags_condition: rec.tags ? 'æœ‰ tags' : 'ç„¡ tags',
			tags_is_array: Array.isArray(rec.tags),
			tags_map_result: rec.tags ? rec.tags.map(tag => tag).join(', ') : 'ç„¡ tags'
		  });
		  // åœ–ç‰‡ä½”ä½
		  const imgHtml = `<img id="${imgId}" alt="${rec.podcast_name}" style="width: 80px; height: 80px; object-fit: cover; border-radius: 8px;">`;
		  
		  const item = document.createElement('div');
		  item.className = 'recommend-item';
		  item.innerHTML = `
			${imgHtml}
			<img src="images/play_gray.png" alt="æ’­æ”¾" class="play-button" id="${playBtnId}" style="cursor:pointer; width:44px; height:44px;" onclick="playOrPauseAudio(this, '${rec.rss_id}', '${rec.episode_title}', '${rec.category || ''}')">
		<div class="text">
			  <div class="title">${rec.podcast_name}</div>
			  <p class="description">${rec.episode_title}</p>
			  <div class="tags-container" style="margin-top: 8px; border: 1px solid red; padding: 4px;">
				${rec.tags ? rec.tags.map(tag => `<span class="tag" style="display: inline-block; background: #f0f0f0; color: #666; padding: 2px 6px; margin: 2px; border-radius: 12px; font-size: 11px;">${tag}</span>`).join('') : '<span style="color: red;">ç„¡ tags å¯é¡¯ç¤º</span>'}
		</div>
			</div>
			<div class="heart-container" title="Like" onclick="toggleLike(${index}, ${rec.episode_id}, '${rec.podcast_name}', '${rec.episode_title}', '${rec.rss_id}')">
			  <input type="checkbox" class="checkbox" id="like-${index}">
		  <div class="svg-container">
			<svg viewBox="0 0 24 24" class="svg-outline" xmlns="http://www.w3.org/2000/svg">
				  <path d="M17.5,1.917a6.4,6.4,0,0,0-5.5,3.3,6.4,6.4,0,0,0-5.5-3.3A6.8,6.8,0,0,0,0,8.967c0,4.547,4.786,9.513,8.8,12.88a4.974,4.974,0,0,0,6.4,0C19.214,18.48,24,13.514,24,8.967A6.8,6.8,0,0,0,17.5,1.917Zm-3.585,18.4a2.973,2.973,0,0,1-3.83,0C4.947,16.006,2,11.87,2,8.967a4.8,4.8,0,0,1,4.5-5.05A4.8,4.8,0,0,1,11,8.967a1,1,0,0,0,2,0,4.8,4.8,0,0,1,4.5-5.05A4.8,4.8,0,0,1,22,8.967C22,11.87,19.053,16.006,13.915,20.313Z"></path>
			</svg>
			<svg viewBox="0 0 24 24" class="svg-filled" xmlns="http://www.w3.org/2000/svg">
				  <path d="M17.5,1.917a6.4,6.4,0,0,0-5.5,3.3,6.4,6.4,0,0,0-5.5-3.3A6.8,6.8,0,0,0,0,8.967c0,4.547,4.786,9.513,8.8,12.88a4.974,4.974,0,0,0,6.4,0C19.214,18.48,24,13.514,24,8.967A6.8,6.8,0,0,0,17.5,1.917Z"></path>
			</svg>
			<svg class="svg-celebrate" width="100" height="100" xmlns="http://www.w3.org/2000/svg">
			  <polygon points="10,10 20,20"></polygon>
			  <polygon points="10,50 20,50"></polygon>
			  <polygon points="20,80 30,70"></polygon>
			  <polygon points="90,10 80,20"></polygon>
			  <polygon points="90,50 80,50"></polygon>
			  <polygon points="80,80 70,70"></polygon>
			</svg>
		  </div>
		</div>
		  `;
		  container.appendChild(item);
		  
		  // å¼·åˆ¶è¨­ç½® checkbox ç‚ºæœªé¸ä¸­ç‹€æ…‹
		  const checkbox = document.getElementById(`like-${index}`);
		  if (checkbox) {
			checkbox.checked = false;
			checkbox.removeAttribute('checked');
		  }
		  
		  // å‹•æ…‹è¼‰å…¥åœ–ç‰‡
		  setPodcastImage(document.getElementById(imgId), rssId);
		});
	  }
	  
	  // è¨­å®šç¯€ç›®åœ–ç‰‡ï¼ˆå¾ MinIO è¼‰å…¥ï¼‰
	  function setPodcastImage(imgElement, rssId) {
		if (!imgElement || !rssId) {
		  console.error('setPodcastImage: ç¼ºå°‘å¿…è¦åƒæ•¸', { imgElement, rssId });
		  return;
		}
		
		console.log('é–‹å§‹è¼‰å…¥åœ–ç‰‡ï¼ŒRSS ID:', rssId);
		
		// å˜—è©¦å¾ MinIO è¼‰å…¥åœ–ç‰‡
		const sizes = ['300', '640', '64'];
		let currentSizeIndex = 0;
		
		function tryNextSize() {
		  if (currentSizeIndex >= sizes.length) {
			// æ‰€æœ‰å°ºå¯¸éƒ½å¤±æ•—ï¼Œä½¿ç”¨é è¨­åœ–ç‰‡
			console.log('æ‰€æœ‰åœ–ç‰‡å°ºå¯¸éƒ½å¤±æ•—ï¼Œä½¿ç”¨é è¨­åœ–ç‰‡');
			imgElement.src = 'images/default_podcast.png';
			return;
		  }
		  
		  const size = sizes[currentSizeIndex];
		  // ä½¿ç”¨ MinIO é ç°½å URL æ ¼å¼
		  const imageUrl = `http://localhost:9000/podcast-images/RSS_${rssId}_${size}.jpg`;
		  
		  console.log(`å˜—è©¦è¼‰å…¥åœ–ç‰‡: ${imageUrl}`);
		  
		  // æ¸¬è©¦åœ–ç‰‡æ˜¯å¦å¯è¼‰å…¥
		  const testImg = new Image();
		  testImg.onload = function() {
			console.log(`æˆåŠŸè¼‰å…¥åœ–ç‰‡: ${imageUrl}`);
			imgElement.src = imageUrl;
		  };
		  testImg.onerror = function() {
			console.log(`åœ–ç‰‡è¼‰å…¥å¤±æ•—: ${imageUrl}`);
			currentSizeIndex++;
			tryNextSize();
		  };
		  testImg.src = imageUrl;
		}
		
		tryNextSize();
	  }
	  
	  let globalAudio = null;
	  let currentPlayButton = null;
	  let lastAudioUrl = '';
	  let lastAudioTime = 0;

	  // ä¿®æ­£ 1: playOrPauseAudio æš«åœ/æ’­æ”¾åˆ‡æ›
	  async function playOrPauseAudio(button, rssId, episodeTitle, category) {
		try {
		  console.log('playOrPauseAudio è¢«å‘¼å«:', { rssId, episodeTitle, category });
		  console.log('ç•¶å‰æŒ‰éˆ•ç‹€æ…‹:', button.src);
		  console.log('globalAudio ç‹€æ…‹:', globalAudio ? (globalAudio.paused ? 'paused' : 'playing') : 'null');

		  // æª¢æŸ¥æ˜¯å¦ç‚ºåŒä¸€é¦–æ­Œæ›²çš„æš«åœ/æ’­æ”¾åˆ‡æ›
		  const apiCategory = mapCategoryToAPI(currentCategory);
		  const response = await fetch('http://localhost:8006/api/audio/stream', {
			method: 'POST',
			headers: { 'Content-Type': 'application/json' },
			body: JSON.stringify({ rss_id: rssId, episode_title: episodeTitle, category: apiCategory })
		  });
		  if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
		  const data = await response.json();
		  const audioUrl = data.audio_url;
		  if (!audioUrl) throw new Error('ç„¡æ³•ç²å–éŸ³æª” URL');

		  // å¦‚æœå·²ç¶“æœ‰ audio ç‰©ä»¶ä¸”æ˜¯åŒä¸€é¦–æ­Œæ›²
		  if (globalAudio && lastAudioUrl === audioUrl) {
			if (!globalAudio.paused) {
			  // æ­£åœ¨æ’­æ”¾ï¼ŒåŸ·è¡Œæš«åœ
			  console.log('åŸ·è¡Œæš«åœ');
			  globalAudio.pause();
			  lastAudioTime = globalAudio.currentTime;
			  button.src = 'images/play_gray.png';
			  return;
			} else {
			  // å·²æš«åœï¼ŒåŸ·è¡Œæ’­æ”¾
			  console.log('åŸ·è¡Œæ’­æ”¾');
			  globalAudio.currentTime = lastAudioTime;
			  globalAudio.play();
			  button.src = 'images/stop_gray.png';
			  return;
			}
		  }

		  // å¦‚æœæ˜¯æ–°æ­Œæ›²æˆ–æ²’æœ‰ audio ç‰©ä»¶ï¼Œå…ˆåœæ­¢ç•¶å‰æ’­æ”¾
		  if (globalAudio) {
			console.log('åœæ­¢ç•¶å‰æ’­æ”¾ï¼Œåˆ‡æ›åˆ°æ–°æ­Œæ›²');
			globalAudio.pause();
			if (currentPlayButton && currentPlayButton !== button) {
			  currentPlayButton.src = 'images/play_gray.png';
			}
		  }

		  // å»ºç«‹æ–°çš„ audio ç‰©ä»¶
		  console.log('å»ºç«‹æ–°éŸ³æª”ç‰©ä»¶');
		  globalAudio = new Audio(audioUrl);
		  lastAudioUrl = audioUrl;
		  lastAudioTime = 0;
		  currentPlayButton = button;

		  // è¨­å®šäº‹ä»¶ç›£è½å™¨
		  globalAudio.addEventListener('ended', () => {
			console.log('æ’­æ”¾çµæŸ');
			button.src = 'images/play_gray.png';
			lastAudioTime = 0;
		  });
		  
		  globalAudio.addEventListener('pause', () => {
			console.log('æš«åœäº‹ä»¶è§¸ç™¼');
			button.src = 'images/play_gray.png';
		  });
		  
		  globalAudio.addEventListener('play', () => {
			console.log('æ’­æ”¾äº‹ä»¶è§¸ç™¼');
			button.src = 'images/stop_gray.png';
		  });
		  
		  globalAudio.addEventListener('error', (e) => {
			console.log('æ’­æ”¾éŒ¯èª¤:', e);
			button.src = 'images/play_gray.png';
			alert('éŸ³æª”æ’­æ”¾å¤±æ•—');
		  });

		  // é–‹å§‹æ’­æ”¾
		  console.log('é–‹å§‹æ’­æ”¾æ–°æ­Œæ›²');
		  await globalAudio.play();
		  button.src = 'images/stop_gray.png';

		} catch (error) {
		  console.error('æ’­æ”¾å¤±æ•—:', error);
		  button.src = 'images/play_gray.png';
		  alert('æ’­æ”¾å¤±æ•—: ' + error.message);
		}
	  }
	  
	  // æ’­æ”¾éŸ³æª”
	  async function playAudio(audioUrl, episodeId, podcastName, episodeTitle, rssId) {
		try {
		  console.log('é–‹å§‹æ’­æ”¾éŸ³æª”:', audioUrl);
		  
		  // æª¢æŸ¥æ˜¯å¦ç‚º MinIO éŸ³æª” URL
		  let finalAudioUrl = audioUrl;
		  
		  // å¦‚æœ URL ä¸åŒ…å« localhost:9000ï¼ˆMinIO é ç°½å URLï¼‰ï¼Œå‰‡å˜—è©¦ç²å–
		  if (!audioUrl.includes('localhost:9000') && !audioUrl.includes('audio/sample')) {
			try {
			  const response = await fetch('http://localhost:8006/api/audio/stream', {
				method: 'POST',
				headers: {
				  'Content-Type': 'application/json',
				},
				body: JSON.stringify({
				  rss_id: rssId,
				  episode_title: episodeTitle,
				  category: mapCategoryToAPI(currentCategory)
				})
			  });
			  
			  if (response.ok) {
				const data = await response.json();
				if (data.audio_url) {
				  finalAudioUrl = data.audio_url;
				  console.log('å¾ MinIO ç²å–éŸ³æª”:', finalAudioUrl);
				}
			  }
			} catch (error) {
			  console.log('ç„¡æ³•å¾ MinIO ç²å–éŸ³æª”ï¼Œä½¿ç”¨é è¨­éŸ³æª”');
			}
		  }
		  
		  // åœæ­¢ç•¶å‰æ’­æ”¾çš„éŸ³æª”
		  const existingAudio = document.getElementById('audio-player');
		  if (existingAudio) {
			existingAudio.pause();
			existingAudio.currentTime = 0;
		  }
		  
		  // å‰µå»ºæ–°çš„éŸ³æª”å…ƒç´ 
		  const audio = new Audio();
		  audio.id = 'audio-player';
		  audio.src = finalAudioUrl;
		  
		  // æ·»åŠ æ’­æ”¾äº‹ä»¶ç›£è½å™¨
		  audio.addEventListener('loadstart', () => {
			console.log('é–‹å§‹è¼‰å…¥éŸ³æª”...');
		  });
		  
		  audio.addEventListener('canplay', () => {
			console.log('éŸ³æª”å¯ä»¥æ’­æ”¾');
		  });
		  
		  audio.addEventListener('play', () => {
			console.log('é–‹å§‹æ’­æ”¾:', podcastName, '-', episodeTitle);
			// é¡¯ç¤ºæ’­æ”¾ç‹€æ…‹
			showPlayStatus(podcastName, episodeTitle, true);
		  });
		  
		  audio.addEventListener('ended', () => {
			console.log('æ’­æ”¾çµæŸ');
			showPlayStatus(podcastName, episodeTitle, false);
		  });
		  
		  audio.addEventListener('error', (e) => {
			console.error('æ’­æ”¾éŒ¯èª¤:', e);
			alert('éŸ³æª”æ’­æ”¾å¤±æ•—ï¼Œè«‹æª¢æŸ¥éŸ³æª”æ˜¯å¦å­˜åœ¨');
			showPlayStatus(podcastName, episodeTitle, false);
		  });
		  
		  // é–‹å§‹æ’­æ”¾
		  const playPromise = audio.play();
		  if (playPromise !== undefined) {
			playPromise.then(() => {
			  // æ’­æ”¾æˆåŠŸ
			  console.log('æ’­æ”¾æˆåŠŸå•Ÿå‹•');
			}).catch(error => {
			  console.error('æ’­æ”¾å¤±æ•—:', error);
			  alert('æ’­æ”¾å¤±æ•—ï¼Œå¯èƒ½æ˜¯ç€è¦½å™¨é˜»æ­¢äº†è‡ªå‹•æ’­æ”¾');
			});
		  }
		  
		  // è¨˜éŒ„æ’­æ”¾è¡Œç‚º
		  recordFeedback('play', episodeId, podcastName, episodeTitle, rssId);
		  
		} catch (error) {
		  console.error('æ’­æ”¾å¤±æ•—:', error);
		  alert('æ’­æ”¾å¤±æ•—: ' + error.message);
		}
	  }
	  
	  // é¡¯ç¤ºæ’­æ”¾ç‹€æ…‹
	  function showPlayStatus(podcastName, episodeTitle, isPlaying) {
		// å‰µå»ºæˆ–æ›´æ–°æ’­æ”¾ç‹€æ…‹æç¤º
		let statusDiv = document.getElementById('play-status');
		if (!statusDiv) {
		  statusDiv = document.createElement('div');
		  statusDiv.id = 'play-status';
		  statusDiv.style.cssText = `
			position: fixed;
			top: 20px;
			right: 20px;
			background: ${isPlaying ? '#4CAF50' : '#f44336'};
			color: white;
			padding: 10px 15px;
			border-radius: 5px;
			z-index: 10000;
			font-size: 14px;
			box-shadow: 0 2px 10px rgba(0,0,0,0.2);
		  `;
		  document.body.appendChild(statusDiv);
		}
		
		statusDiv.textContent = isPlaying ? 
		  `ğŸµ æ­£åœ¨æ’­æ”¾: ${podcastName} - ${episodeTitle}` : 
		  `â¹ï¸ æ’­æ”¾çµæŸ: ${podcastName} - ${episodeTitle}`;
		
		// 3ç§’å¾Œè‡ªå‹•éš±è—
		setTimeout(() => {
		  if (statusDiv && !isPlaying) {
			statusDiv.remove();
		  }
		}, 3000);
	  }
	  
	  // åˆ‡æ›å–œæ­¡ç‹€æ…‹
	  function toggleLike(index, episodeId, podcastName, episodeTitle, rssId) {
		const checkbox = document.getElementById(`like-${index}`);
		const heartContainer = checkbox.closest('.heart-container');
		const isLiked = checkbox.checked;
		
		console.log('toggleLike è¢«å‘¼å«:', { index, episodeId, isLiked });
		
		// åˆ‡æ› checkbox ç‹€æ…‹
		checkbox.checked = !isLiked;
		
		// æ·»åŠ æ„›å¿ƒå‹•ç•«æ•ˆæœ
		if (!isLiked) {
		  // å–œæ­¡å‹•ç•«
		  heartContainer.style.transform = 'scale(1.2)';
		  setTimeout(() => {
			heartContainer.style.transform = 'scale(1)';
		  }, 200);
		  
		  // é¡¯ç¤ºæ…¶ç¥å‹•ç•«
		  const celebrateSvg = heartContainer.querySelector('.svg-celebrate');
		  if (celebrateSvg) {
			celebrateSvg.style.display = 'block';
			celebrateSvg.style.animation = 'keyframes-svg-celebrate 0.6s ease-out';
			setTimeout(() => {
			  celebrateSvg.style.display = 'none';
			}, 600);
		  }
		}
		
		// æ›´æ–°é¸ä¸­çš„ç¯€ç›®åˆ—è¡¨
		const episodeData = {
		  episode_id: episodeId,
		  podcast_name: podcastName,
		  episode_title: episodeTitle,
		  rss_id: rssId
		};
		
		if (!isLiked) {
		  // æ·»åŠ åˆ°é¸ä¸­åˆ—è¡¨
		  selectedEpisodes.push(episodeData);
		  recordFeedback('like', episodeId, podcastName, episodeTitle, rssId);
		  console.log(`â¤ï¸ å–œæ­¡ç¯€ç›®: ${podcastName} - ${episodeTitle}`);
		} else {
		  // å¾é¸ä¸­åˆ—è¡¨ç§»é™¤
		  selectedEpisodes = selectedEpisodes.filter(ep => ep.episode_id !== episodeId);
		  recordFeedback('unlike', episodeId, podcastName, episodeTitle, rssId);
		  console.log(`ğŸ’” å–æ¶ˆå–œæ­¡: ${podcastName} - ${episodeTitle}`);
		}
		
		console.log('é¸ä¸­çš„ç¯€ç›®æ•¸é‡:', selectedEpisodes.length);
		console.log('é¸ä¸­çš„ç¯€ç›®:', selectedEpisodes);
		
		// é¡¯ç¤ºç”¨æˆ¶åå¥½æç¤º
		showPreferenceNotification(podcastName, episodeTitle, !isLiked);
	  }
	  
	  // é¡¯ç¤ºç”¨æˆ¶åå¥½æç¤º
	  function showPreferenceNotification(podcastName, episodeTitle, isLiked) {
		// å‰µå»ºæˆ–æ›´æ–°åå¥½æç¤º
		let notificationDiv = document.getElementById('preference-notification');
		if (!notificationDiv) {
		  notificationDiv = document.createElement('div');
		  notificationDiv.id = 'preference-notification';
		  notificationDiv.style.cssText = `
			position: fixed;
			top: 80px;
			right: 20px;
			background: ${isLiked ? '#4CAF50' : '#f44336'};
			color: white;
			padding: 12px 18px;
			border-radius: 8px;
			z-index: 10000;
			font-size: 14px;
			box-shadow: 0 4px 12px rgba(0,0,0,0.3);
			max-width: 300px;
			word-wrap: break-word;
			transform: translateX(100%);
			transition: transform 0.3s ease;
		  `;
		  document.body.appendChild(notificationDiv);
		}
		
		const emoji = isLiked ? 'â¤ï¸' : 'ğŸ’”';
		const action = isLiked ? 'å·²åŠ å…¥å–œå¥½' : 'å·²ç§»é™¤å–œå¥½';
		
		notificationDiv.innerHTML = `
		  <div style="display: flex; align-items: center; gap: 8px;">
			<span style="font-size: 18px;">${emoji}</span>
			<div>
			  <div style="font-weight: bold;">${action}</div>
			  <div style="font-size: 12px; opacity: 0.9;">${podcastName}</div>
			  <div style="font-size: 11px; opacity: 0.8;">${episodeTitle}</div>
	  </div>
	</div>
  `;
		
		// é¡¯ç¤ºå‹•ç•«
		setTimeout(() => {
		  notificationDiv.style.transform = 'translateX(0)';
		}, 100);
		
		// 3ç§’å¾Œè‡ªå‹•éš±è—
		setTimeout(() => {
		  notificationDiv.style.transform = 'translateX(100%)';
		  setTimeout(() => {
			if (notificationDiv) {
			  notificationDiv.remove();
			}
		  }, 300);
		}, 3000);
	  }
	  
	  // è¨˜éŒ„ç”¨æˆ¶åé¥‹
	  async function recordFeedback(action, episodeId, podcastName, episodeTitle, rssId) {
		try {
		  const response = await fetch('http://localhost:8007/api/feedback', {
			method: 'POST',
			headers: {
			  'Content-Type': 'application/json',
			},
			body: JSON.stringify({
			  user_id: 'temp_user', // æš«æ™‚ç”¨æˆ¶ ID
			  episode_id: episodeId,
			  podcast_name: podcastName,
			  episode_title: episodeTitle,
			  rss_id: rssId,
			  action: action,
			  category: mapCategoryToAPI(currentCategory)
			})
		  });
		  
		  if (response.ok) {
			console.log(`${action} æ“ä½œè¨˜éŒ„æˆåŠŸ`);
		  }
		  
		} catch (error) {
		  console.error('è¨˜éŒ„åé¥‹å¤±æ•—:', error);
		}
	  }
	  
	  // é‡æ–°æ•´ç†æ¨è–¦
	  function refreshRecommendations() {
		loadRecommendations();
	  }
	  
	  // é é¢è¼‰å…¥æ™‚è¼‰å…¥æ¨è–¦
	  document.addEventListener('DOMContentLoaded', () => {
		// å»¶é²è¼‰å…¥ï¼Œç¢ºä¿ Step 2 å·²å®Œæˆ
		setTimeout(loadRecommendations, 100);
	  });
	  
	  // é é¢é›¢é–‹æ™‚åœæ­¢éŸ³æª”æ’­æ”¾
	  window.addEventListener('beforeunload', () => {
		if (globalAudio) {
		  globalAudio.pause();
		  globalAudio = null;
		}
	  });
	  
	  // ä¿®æ­£ goToStep å‡½æ•¸ï¼Œåœ¨è·³è½‰æ™‚åœæ­¢éŸ³æª”
	  function goToStep(step) {
		// åœæ­¢ç•¶å‰æ’­æ”¾çš„éŸ³æª”
		if (globalAudio) {
		  globalAudio.pause();
		  globalAudio = null;
		  if (currentPlayButton) {
			currentPlayButton.src = 'images/play_gray.png';
		  }
		}
		
		// éš±è—æ‰€æœ‰æ­¥é©Ÿ
		for (let i = 1; i <= 4; i++) {
		  const el = document.getElementById(`popup-step-${i}`);
		  if (el) el.style.display = 'none';
		}
		
		// é¡¯ç¤ºæŒ‡å®šæ­¥é©Ÿ
		const targetEl = document.getElementById(`popup-step-${step}`);
		if (targetEl) targetEl.style.display = 'block';
		
		// å¦‚æœæ˜¯æ­¥é©Ÿ 4ï¼ŒåŸ·è¡Œé¡å¤–é‚è¼¯
		if (step === 4) {
		  // é€™è£¡å¯ä»¥æ·»åŠ æ­¥é©Ÿ 4 çš„ç‰¹æ®Šé‚è¼¯
		}
	  }
	</script>
  </div>
  
			<!-- Step 4 -->
<div class="popup-step" id="popup-step-4" style="display: none;">
  <h2 style="color: #7c4dff;">Sign in Your Podwise</h2>
  <!-- é€™è£¡é–‹å§‹ï¼š -->
  <div class="form-center">
    <!-- Podwise ID è¼¸å…¥ -->
    <input
      type="text"
      name="demo-name"
      id="demo-name"
      placeholder="è¼¸å…¥ä½ çš„Podwise ID"
    />

    <!-- or åˆ†éš” -->
    <span style="color:#666;">â€” or â€”</span>

    <!-- ç”¢ç”Ÿ ID æŒ‰éˆ• -->
    <input
      type="button"
      value="ç”¢ç”ŸPodwise ID"
      id="generateIdBtn"
      class="secondary"
      onclick="generatePodwiseID()"
    />

    <!-- é¡¯ç¤ºç”¢ç”Ÿå¾Œçš„ ID -->
    <input
      type="text"
      id="podwiseIdField"
      readonly
      placeholder="Generating..."
    />

    <!-- é€²å…¥ Podwise æŒ‰éˆ• -->
    <button
      type="button"
      class="button primary"
      onclick="enterPodwise()"
    >
      é€²å…¥Podwise
    </button>
  </div>
  <!-- é€™è£¡çµæŸ -->
</div>

									<script>
										async function generatePodwiseID() {
											try {
												// é¡¯ç¤ºè¼‰å…¥ç‹€æ…‹
												const idField = document.getElementById('podwiseIdField');
												const generateBtn = document.getElementById('generateIdBtn');
												
												idField.value = 'æ­£åœ¨ç”Ÿæˆ...';
												generateBtn.disabled = true;
												generateBtn.value = 'ç”Ÿæˆä¸­...';
												
												// èª¿ç”¨å¾Œç«¯ API ç”Ÿæˆ Podwise ID
												const response = await fetch('/api/generate-podwise-id', {
													method: 'POST',
													headers: {
														'Content-Type': 'application/json',
													}
												});
												
												if (response.ok) {
													const data = await response.json();
													if (data.success) {
														// é¡¯ç¤ºç”Ÿæˆçš„ Podwise ID
														idField.value = data.podwise_id;
														console.log('Podwise ID ç”ŸæˆæˆåŠŸ:', data.podwise_id);
													} else {
														throw new Error(data.message || 'ç”Ÿæˆå¤±æ•—');
													}
												} else {
													throw new Error('API è«‹æ±‚å¤±æ•—');
												}
												
											} catch (error) {
												console.error('ç”Ÿæˆ Podwise ID å¤±æ•—:', error);
												document.getElementById('podwiseIdField').value = 'ç”Ÿæˆå¤±æ•—ï¼Œè«‹é‡è©¦';
												alert('ç”Ÿæˆ Podwise ID å¤±æ•—ï¼Œè«‹é‡è©¦');
											} finally {
												// æ¢å¾©æŒ‰éˆ•ç‹€æ…‹
												const generateBtn = document.getElementById('generateIdBtn');
												generateBtn.disabled = false;
												generateBtn.value = 'ç”¢ç”ŸPodwise ID';
											}
										}
										
										// æ”¶é›†æ‰€æœ‰ Like çš„ç¯€ç›®è³‡è¨Š
										function collectLikedEpisodes() {
										  const likedEpisodes = [];
										  if (window.currentRecommendations) {
										    window.currentRecommendations.forEach((rec, idx) => {
										      const checkbox = document.getElementById(`like-${idx}`);
										      if (checkbox && checkbox.checked) {
										        likedEpisodes.push({
										          podcast_name: rec.podcast_name,
										          episode_title: rec.episode_title,
										          rss_id: rec.rss_id,
										          episode_id: rec.episode_id
										        });
										      }
										    });
										  }
										  window.selectedEpisodes = likedEpisodes;
										}
										
										// é€²å…¥ Podwise æŒ‰éˆ•è§¸ç™¼
										async function enterPodwise() {
										  collectLikedEpisodes(); // å…ˆæ”¶é›† Like ç¯€ç›®
										
										  const userIdInput = document.getElementById('demo-name');
										  const generatedIdInput = document.getElementById('podwiseIdField');
										  let userId = userIdInput.value.trim();
										  const isNewUser = generatedIdInput.value.trim() !== '';
										  if (isNewUser) {
										    userId = generatedIdInput.value.trim();
										  }
										  if (!userId) {
										    alert('è«‹è¼¸å…¥æˆ–ç”¢ç”Ÿ Podwise ID');
										    return;
										  }
										  try {
										    if (isNewUser) {
										      await registerNewUser(userId);
										    } else {
										      const exists = await checkUserExists(userId);
										      if (!exists) {
										        await registerNewUser(userId);
										      }
										    }
										    window.location.href = 'index.html';
										  } catch (error) {
										    alert('ç™»å…¥å¤±æ•—ï¼Œè«‹é‡è©¦');
										  }
										}
										
										async function checkUserExists(userId) {
											try {
												const response = await fetch(`/api/user/check/${userId}`);
												const data = await response.json();
												return data.exists;
											} catch (error) {
												console.error('æª¢æŸ¥ç”¨æˆ¶å¤±æ•—:', error);
												return false;
											}
										}
										
										async function registerNewUser(userId) {
											try {
												const response = await fetch('/api/user/register', {
													method: 'POST',
													headers: {
														'Content-Type': 'application/json',
													},
													body: JSON.stringify({
														user_id: userId,
														category: window.selectedCategory || 'business',
														selected_episodes: window.selectedEpisodes || []
													})
												});
												
												if (response.ok) {
													console.log('ç”¨æˆ¶è¨»å†ŠæˆåŠŸ');
												} else {
													throw new Error('è¨»å†Šå¤±æ•—');
												}
												
											} catch (error) {
												console.error('è¨»å†Šç”¨æˆ¶å¤±æ•—:', error);
												throw error;
											}
										}
									</script>
						<!-- <button type="button" class="button" onclick="closePopup()">é€²å…¥Podwise</button> -->
								</div>

						</div>
					</div>

					<!-- Scripts -->
					<script src="assets/js/jquery.min.js"></script>
					<script src="assets/js/browser.min.js"></script>
					<script src="assets/js/breakpoints.min.js"></script>
					<script src="assets/js/util.js"></script>
					<script src="assets/js/main.js"></script>
					<script>
						// åˆæ¬¡é¡¯ç¤º
						window.addEventListener('DOMContentLoaded', () => {
							document.getElementById('popup-overlay').style.display = 'flex';
						});

						// åˆ‡æ›æ­¥é©Ÿï¼ˆå·²åœ¨ä¸Šæ–¹å®šç¾©ï¼Œé€™è£¡ç§»é™¤é‡è¤‡å®šç¾©ï¼‰

						// å‘å¾Œç«¯å–å¾— ID ä¸¦é¡¯ç¤º
						function fetchGeneratedCode() {
							fetch('/api/get-id')
								.then(res => res.text())
								.then(code => {
									document.getElementById('generated-code').textContent = code;
								})
								.catch(() => {
									document.getElementById('generated-code').textContent = 'å–å¾—å¤±æ•—';
								});
						}

						// è¤‡è£½æŒ‰éˆ•
						// document.addEventListener('DOMContentLoaded', () => {
						// 	document.getElementById('copy-code-btn').addEventListener('click', () => {
						// 		const code = document.getElementById('generated-code').textContent;
						// 		navigator.clipboard.writeText(code)
						// 			.then(() => alert('å·²è¤‡è£½åˆ°å‰ªè²¼ç°¿ï¼'))
						// 			.catch(() => alert('è¤‡è£½å¤±æ•—'));
						// 	});
						// });

						// é—œé–‰
						function closePopup() {
							document.getElementById('popup-overlay').style.display = 'none';
						}
					</script>
        <!-- Step 4 çµæŸ -->
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Footer æ‡‰è©²åœ¨é€™è£¡ï¼Œç¨ç«‹æ–¼ popup ä¹‹å¤– -->
<footer id="footer" style="background:#dddada; padding:2em 0; text-align:center; margin-top:3em;">
  <div class="inner">
    <p style="margin:0; color:#3d4449;">&copy; 2025 PodWise. All rights reserved.</p>
    <p style="margin:0; font-size:0.9em; color:#3d4449;">Designed by PodWise Team</p>
</footer>

</body>
</html>