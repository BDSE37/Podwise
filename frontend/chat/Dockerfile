# ä½¿ç”¨ Python 3.10 ä½œç‚ºåŸºç¤æ˜ åƒ
FROM docker.io/library/python:3.10-slim

# è¨­å®šå·¥ä½œç›®éŒ„
WORKDIR /app

# å®‰è£ç³»çµ±ä¾è³´
RUN apt-get update && apt-get install -y \
    curl \
    && rm -rf /var/lib/apt/lists/*

# è¤‡è£½ requirements.txt
COPY requirements.txt .

# å®‰è£ Python ä¾è³´
RUN pip install --no-cache-dir -r requirements.txt

# è¤‡è£½æ‡‰ç”¨ç¨‹å¼ä»£ç¢¼
COPY . .

# å‰µå»ºå¥åº·æª¢æŸ¥ç«¯é»
RUN echo 'import streamlit as st\n\
st.set_page_config(page_title="Podri Chat", page_icon="ğŸ¦Š")\n\
st.write("Podri Chat æœå‹™æ­£å¸¸é‹è¡Œ")\n\
' > health_check.py

# æš´éœ²ç«¯å£
EXPOSE 8501

# è¨­å®šç’°å¢ƒè®Šæ•¸
ENV STREAMLIT_SERVER_PORT=8501
ENV STREAMLIT_SERVER_ADDRESS=0.0.0.0
ENV STREAMLIT_SERVER_HEADLESS=true

# å•Ÿå‹•å‘½ä»¤
CMD ["streamlit", "run", "podri_chat.py", "--server.port=8501", "--server.address=0.0.0.0"] 