"""
æ–‡æœ¬æ¸…ç†å·¥å…·
è™•ç†è¡¨æƒ…ç¬¦è™Ÿã€ç‰¹æ®Šå­—ç¬¦å’Œæ¨™æº–åŒ–æ–‡æœ¬ï¼Œç¢ºä¿è³‡æ–™åº«åŒ¹é…çš„æº–ç¢ºæ€§
"""

import re
import unicodedata
from typing import Optional, List, Dict, Any
import logging

logger = logging.getLogger(__name__)


class TextCleaner:
    """æ–‡æœ¬æ¸…ç†å™¨ - è™•ç†è¡¨æƒ…ç¬¦è™Ÿå’Œç‰¹æ®Šå­—ç¬¦"""
    
    def __init__(self):
        # å¸¸è¦‹è¡¨æƒ…ç¬¦è™Ÿæ˜ å°„
        self.emoji_mapping = {
            'ğŸ˜€': '[ç¬‘è‡‰]', 'ğŸ˜ƒ': '[å¤§ç¬‘]', 'ğŸ˜„': '[é–‹å¿ƒ]', 'ğŸ˜': '[å¾®ç¬‘]',
            'ğŸ˜†': '[ç¬‘]', 'ğŸ˜…': '[æ±—ç¬‘]', 'ğŸ˜‚': '[ç¬‘å“­]', 'ğŸ¤£': '[ç¬‘ç¿»]',
            'ğŸ˜Š': '[å®³ç¾]', 'ğŸ˜‡': '[å¤©ä½¿]', 'ğŸ™‚': '[å¾®ç¬‘]', 'ğŸ™ƒ': '[å€’ç¬‘]',
            'ğŸ˜‰': '[çœ¨çœ¼]', 'ğŸ˜Œ': '[æ”¾é¬†]', 'ğŸ˜': '[æ„›å¿ƒ]', 'ğŸ¥°': '[æ„›]',
            'ğŸ˜˜': '[é£›å»]', 'ğŸ˜—': '[è¦ªå»]', 'ğŸ˜™': '[è¦ª]', 'ğŸ˜š': '[è¦ªè¦ª]',
            'ğŸ˜‹': '[å¥½åƒ]', 'ğŸ˜›': '[åèˆŒ]', 'ğŸ˜': '[åèˆŒé ­]', 'ğŸ˜œ': '[çœ¨çœ¼åèˆŒ]',
            'ğŸ¤ª': '[ç˜‹ç‹‚]', 'ğŸ¤¨': '[æ‡·ç–‘]', 'ğŸ§': '[åµæ¢]', 'ğŸ¤“': '[æ›¸å‘†å­]',
            'ğŸ˜': '[é…·]', 'ğŸ¤©': '[æ˜Ÿæ˜Ÿçœ¼]', 'ğŸ¥³': '[æ…¶ç¥]', 'ğŸ˜': '[å¾—æ„]',
            'ğŸ˜’': '[ä¸æ»¿]', 'ğŸ˜': '[å¤±æœ›]', 'ğŸ˜”': '[æ†‚é¬±]', 'ğŸ˜Ÿ': '[æ“”å¿ƒ]',
            'ğŸ˜•': '[å›°æƒ‘]', 'ğŸ™': '[ä¸é–‹å¿ƒ]', 'â˜¹ï¸': '[é›£é]', 'ğŸ˜£': '[ç—›è‹¦]',
            'ğŸ˜–': '[ç…©æƒ±]', 'ğŸ˜«': '[ç–²æ†Š]', 'ğŸ˜©': '[ç´¯]', 'ğŸ¥º': '[å¯æ†]',
            'ğŸ˜¢': '[å“­æ³£]', 'ğŸ˜­': '[å¤§å“­]', 'ğŸ˜¤': '[ç”Ÿæ°£]', 'ğŸ˜ ': '[æ†¤æ€’]',
            'ğŸ˜¡': '[æš´æ€’]', 'ğŸ¤¬': '[ç½µäºº]', 'ğŸ¤¯': '[çˆ†ç‚¸]', 'ğŸ˜³': '[éœ‡é©š]',
            'ğŸ¥µ': '[ç†±]', 'ğŸ¥¶': '[å†·]', 'ğŸ˜±': '[å°–å«]', 'ğŸ˜¨': '[ææ‡¼]',
            'ğŸ˜°': '[ç·Šå¼µ]', 'ğŸ˜¥': '[æ“”å¿ƒ]', 'ğŸ˜“': '[æ±—]', 'ğŸ¤—': '[æ“æŠ±]',
            'ğŸ¤”': '[æ€è€ƒ]', 'ğŸ¤­': '[å·ç¬‘]', 'ğŸ¤«': '[å™“]', 'ğŸ¤¥': '[èªªè¬Š]',
            'ğŸ˜¶': '[ç„¡èª]', 'ğŸ˜': '[é¢ç„¡è¡¨æƒ…]', 'ğŸ˜‘': '[å†·æ¼ ]', 'ğŸ˜¯': '[é©šè¨]',
            'ğŸ˜¦': '[å›°æƒ‘]', 'ğŸ˜§': '[ç—›è‹¦]', 'ğŸ˜®': '[é©šè¨]', 'ğŸ˜²': '[éœ‡é©š]',
            'ğŸ˜´': '[ç¡è¦º]', 'ğŸ¤¤': '[æµå£æ°´]', 'ğŸ˜ª': '[ç]', 'ğŸ˜µ': '[æšˆ]',
            'ğŸ¤': '[é–‰å˜´]', 'ğŸ¥´': '[é†‰]', 'ğŸ¤¢': '[å™å¿ƒ]', 'ğŸ¤®': '[å˜”å]',
            'ğŸ¤§': '[æ‰“å™´åš]', 'ğŸ˜·': '[å£ç½©]', 'ğŸ¤’': '[ç™¼ç‡’]', 'ğŸ¤•': '[å—å‚·]',
            'ğŸ¤‘': '[è²ªè²¡]', 'ğŸ¤ ': '[ç‰›ä»”]', 'ğŸ‘»': '[é¬¼]', 'ğŸ‘½': '[å¤–æ˜Ÿäºº]',
            'ğŸ¤–': '[æ©Ÿå™¨äºº]', 'ğŸ˜ˆ': '[æƒ¡é­”]', 'ğŸ‘¿': '[æƒ¡é­”]', 'ğŸ‘¹': '[é£Ÿäººé­”]',
            'ğŸ‘º': '[å¤©ç‹—]', 'ğŸ’€': '[éª·é«]', 'â˜ ï¸': '[éª·é«]', 'ğŸ’©': '[ä¾¿ä¾¿]',
            'ğŸ¤¡': '[å°ä¸‘]', 'ğŸ‘»': '[é¬¼]', 'ğŸ‘½': '[å¤–æ˜Ÿäºº]', 'ğŸ¤–': '[æ©Ÿå™¨äºº]',
            'ğŸƒ': '[å—ç“œ]', 'ğŸ‘¾': '[å¤–æ˜Ÿäºº]', 'ğŸ¤–': '[æ©Ÿå™¨äºº]', 'ğŸ˜º': '[è²“ç¬‘]',
            'ğŸ˜¸': '[è²“é–‹å¿ƒ]', 'ğŸ˜¹': '[è²“ç¬‘å“­]', 'ğŸ˜»': '[è²“æ„›å¿ƒ]', 'ğŸ˜¼': '[è²“å£ç¬‘]',
            'ğŸ˜½': '[è²“è¦ªå»]', 'ğŸ™€': '[è²“é©šè¨]', 'ğŸ˜¿': '[è²“å“­æ³£]', 'ğŸ˜¾': '[è²“ç”Ÿæ°£]',
            'ğŸ™ˆ': '[ä¸çœ‹]', 'ğŸ™‰': '[ä¸è½]', 'ğŸ™Š': '[ä¸èªª]', 'ğŸ’Œ': '[æƒ…æ›¸]',
            'ğŸ’˜': '[æ„›å¿ƒç®­]', 'ğŸ’': '[ç¦®ç‰©æ„›å¿ƒ]', 'ğŸ’–': '[é–ƒäº®æ„›å¿ƒ]', 'ğŸ’—': '[æˆé•·æ„›å¿ƒ]',
            'ğŸ’“': '[è·³å‹•æ„›å¿ƒ]', 'ğŸ’': '[æ—‹è½‰æ„›å¿ƒ]', 'ğŸ’•': '[é›™æ„›å¿ƒ]', 'ğŸ’Ÿ': '[è£é£¾æ„›å¿ƒ]',
            'â£ï¸': '[æ„Ÿå˜†æ„›å¿ƒ]', 'ğŸ’”': '[ç ´ç¢æ„›å¿ƒ]', 'â¤ï¸': '[ç´…å¿ƒ]', 'ğŸ§¡': '[æ©™å¿ƒ]',
            'ğŸ’›': '[é»ƒå¿ƒ]', 'ğŸ’š': '[ç¶ å¿ƒ]', 'ğŸ’™': '[è—å¿ƒ]', 'ğŸ’œ': '[ç´«å¿ƒ]',
            'ğŸ–¤': '[é»‘å¿ƒ]', 'ğŸ¤': '[ç™½å¿ƒ]', 'ğŸ¤': '[æ£•å¿ƒ]', 'ğŸ’¯': '[100åˆ†]',
            'ğŸ’¢': '[æ†¤æ€’]', 'ğŸ’¥': '[çˆ†ç‚¸]', 'ğŸ’«': '[æ˜Ÿæ˜Ÿ]', 'ğŸ’¦': '[æ±—]',
            'ğŸ’¨': '[é¢¨]', 'ğŸ•³ï¸': '[æ´]', 'ğŸ’¬': '[å°è©±æ¡†]', 'ğŸ—¨ï¸': '[å°è©±]',
            'ğŸ—¯ï¸': '[æ†¤æ€’å°è©±]', 'ğŸ’­': '[æ€è€ƒæ¡†]', 'ğŸ’¤': '[ç¡è¦º]', 'ğŸ’®': '[ç™½èŠ±]',
            'â™¨ï¸': '[æº«æ³‰]', 'ğŸ’ˆ': '[ç†é«®åº—]', 'ğŸ›‘': '[åœæ­¢]', 'ğŸ›¢ï¸': '[æ²¹æ¡¶]',
            'ğŸ› ï¸': '[å·¥å…·]', 'ğŸ›¡ï¸': '[ç›¾ç‰Œ]', 'ğŸ›¤ï¸': '[éµè»Œ]', 'ğŸ›¥ï¸': '[æ±½è‰‡]',
            'ğŸ›©ï¸': '[å°é£›æ©Ÿ]', 'ğŸ›«': '[èµ·é£›]', 'ğŸ›¬': '[é™è½]', 'ğŸ›°ï¸': '[è¡›æ˜Ÿ]',
            'ğŸ›³ï¸': '[å®¢è¼ª]', 'ğŸ›´': '[æ»‘æ¿è»Š]', 'ğŸ›µ': '[æ‘©æ‰˜è»Š]', 'ğŸ›¶': '[ç¨æœ¨èˆŸ]',
            'ğŸ›·': '[é›ªæ©‡]', 'ğŸ›¸': '[é£›ç¢Ÿ]', 'ğŸ›¹': '[æ»‘æ¿]', 'ğŸ›º': '[ä¸‰è¼ªè»Š]',
            'ğŸ›»': '[çš®å¡]', 'ğŸ›¼': '[æºœå†°é‹]', 'ğŸŸ ': '[æ©™åœ“]', 'ğŸŸ¡': '[é»ƒåœ“]',
            'ğŸŸ¢': '[ç¶ åœ“]', 'ğŸŸ£': '[ç´«åœ“]', 'ğŸŸ¤': '[æ£•åœ“]', 'âš«': '[é»‘åœ“]',
            'âšª': '[ç™½åœ“]', 'ğŸŸ¥': '[ç´…æ–¹]', 'ğŸŸ§': '[æ©™æ–¹]', 'ğŸŸ¨': '[é»ƒæ–¹]',
            'ğŸŸ©': '[ç¶ æ–¹]', 'ğŸŸ¦': '[è—æ–¹]', 'ğŸŸª': '[ç´«æ–¹]', 'ğŸŸ«': '[æ£•æ–¹]',
            'â¬›': '[é»‘æ–¹]', 'â¬œ': '[ç™½æ–¹]', 'â—¼ï¸': '[é»‘æ–¹]', 'â—»ï¸': '[ç™½æ–¹]',
            'â—¾': '[å°é»‘æ–¹]', 'â—½': '[å°ç™½æ–¹]', 'â–ªï¸': '[å°é»‘æ–¹]', 'â–«ï¸': '[å°ç™½æ–¹]',
            'ğŸ”¶': '[æ©™é‘½]', 'ğŸ”·': '[è—é‘½]', 'ğŸ”¸': '[å°æ©™é‘½]', 'ğŸ”¹': '[å°è—é‘½]',
            'ğŸ”º': '[ç´…ä¸‰è§’]', 'ğŸ”»': '[å€’ç´…ä¸‰è§’]', 'ğŸ’ ': '[é‘½çŸ³]', 'ğŸ”˜': '[åœ“åœˆ]',
            'ğŸ”³': '[ç™½æ–¹]', 'ğŸ”²': '[é»‘æ–¹]', 'ğŸ': '[æ——å¹Ÿ]', 'ğŸš©': '[ç´…æ——]',
            'ğŸŒ': '[äº¤å‰æ——]', 'ğŸ´': '[é»‘æ——]', 'ğŸ³ï¸': '[ç™½æ——]', 'ğŸ³ï¸â€ğŸŒˆ': '[å½©è™¹æ——]',
            'ğŸ´â€â˜ ï¸': '[æµ·ç›œæ——]', 'ğŸ‡¦ğŸ‡¨': '[Ascensionå³¶]', 'ğŸ‡¦ğŸ‡©': '[å®‰é“çˆ¾]', 'ğŸ‡¦ğŸ‡«': '[é˜¿å¯Œæ±—]',
            'ğŸ‡¦ğŸ‡¬': '[å®‰åœ°å¡åŠå·´å¸ƒé”]', 'ğŸ‡¦ğŸ‡®': '[å®‰åœ­æ‹‰]', 'ğŸ‡¦ğŸ‡±': '[é˜¿çˆ¾å·´å°¼äº]', 'ğŸ‡¦ğŸ‡²': '[äºç¾å°¼äº]',
            'ğŸ‡¦ğŸ‡´': '[å®‰å“¥æ‹‰]', 'ğŸ‡¦ğŸ‡¶': '[å—æ¥µæ´²]', 'ğŸ‡¦ğŸ‡·': '[é˜¿æ ¹å»·]', 'ğŸ‡¦ğŸ‡¸': '[ç¾å±¬è–©æ‘©äº]',
            'ğŸ‡¦ğŸ‡¹': '[å¥§åœ°åˆ©]', 'ğŸ‡¦ğŸ‡º': '[æ¾³æ´²]', 'ğŸ‡¦ğŸ‡¼': '[é˜¿é­¯å·´]', 'ğŸ‡¦ğŸ‡½': '[å¥§è˜­ç¾¤å³¶]',
            'ğŸ‡¦ğŸ‡¿': '[äºå¡æ‹œç„¶]', 'ğŸ‡§ğŸ‡¦': '[æ³¢å£«å°¼äºèˆ‡èµ«å¡å“¥ç¶­ç´]', 'ğŸ‡§ğŸ‡§': '[å·´è²å¤š]', 'ğŸ‡§ğŸ‡©': '[å­ŸåŠ æ‹‰]',
            'ğŸ‡§ğŸ‡ª': '[æ¯”åˆ©æ™‚]', 'ğŸ‡§ğŸ‡«': '[å¸ƒå‰ç´æ³•ç´¢]', 'ğŸ‡§ğŸ‡¬': '[ä¿åŠ åˆ©äº]', 'ğŸ‡§ğŸ‡­': '[å·´æ—]',
            'ğŸ‡§ğŸ‡®': '[è’²éš†åœ°]', 'ğŸ‡§ğŸ‡¯': '[è²å—]', 'ğŸ‡§ğŸ‡±': '[è–å·´ç‘Ÿç±³]', 'ğŸ‡§ğŸ‡²': '[ç™¾æ…•é”]',
            'ğŸ‡§ğŸ‡³': '[æ±¶èŠ]', 'ğŸ‡§ğŸ‡´': '[ç»åˆ©ç¶­äº]', 'ğŸ‡§ğŸ‡¶': '[è·è˜­åŠ å‹’æ¯”å€]', 'ğŸ‡§ğŸ‡·': '[å·´è¥¿]',
            'ğŸ‡§ğŸ‡¸': '[å·´å“ˆé¦¬]', 'ğŸ‡§ğŸ‡¹': '[ä¸ä¸¹]', 'ğŸ‡§ğŸ‡»': '[å¸ƒéŸ‹å³¶]', 'ğŸ‡§ğŸ‡¼': '[æ³¢æœ­é‚£]',
            'ğŸ‡§ğŸ‡¾': '[ç™½ä¿„ç¾…æ–¯]', 'ğŸ‡§ğŸ‡¿': '[è²é‡Œæ–¯]', 'ğŸ‡¨ğŸ‡¦': '[åŠ æ‹¿å¤§]', 'ğŸ‡¨ğŸ‡¨': '[ç§‘ç§‘æ–¯ç¾¤å³¶]',
            'ğŸ‡¨ğŸ‡©': '[ä¸­éå…±å’Œåœ‹]', 'ğŸ‡¨ğŸ‡«': '[å‰›æœå…±å’Œåœ‹]', 'ğŸ‡¨ğŸ‡¬': '[å‰›æœæ°‘ä¸»å…±å’Œåœ‹]', 'ğŸ‡¨ğŸ‡­': '[ç‘å£«]',
            'ğŸ‡¨ğŸ‡®': '[è±¡ç‰™æµ·å²¸]', 'ğŸ‡¨ğŸ‡±': '[æ™ºåˆ©]', 'ğŸ‡¨ğŸ‡²': '[å–€éº¥éš†]', 'ğŸ‡¨ğŸ‡³': '[ä¸­åœ‹]',
            'ğŸ‡¨ğŸ‡´': '[å“¥å€«æ¯”äº]', 'ğŸ‡¨ğŸ‡µ': '[å…‹åˆ©ç€é “å³¶]', 'ğŸ‡¨ğŸ‡·': '[å“¥æ–¯å¤§é»åŠ ]', 'ğŸ‡¨ğŸ‡º': '[å¤å·´]',
            'ğŸ‡¨ğŸ‡»': '[ç¶­å¾·è§’]', 'ğŸ‡¨ğŸ‡¼': '[åº«æ‹‰ç´¢]', 'ğŸ‡¨ğŸ‡½': '[è–èª•å³¶]', 'ğŸ‡¨ğŸ‡¾': '[è³½æ™®å‹’æ–¯]',
            'ğŸ‡¨ğŸ‡¿': '[æ·å…‹]', 'ğŸ‡©ğŸ‡ª': '[å¾·åœ‹]', 'ğŸ‡©ğŸ‡¯': '[å‰å¸ƒåœ°]', 'ğŸ‡©ğŸ‡°': '[ä¸¹éº¥]',
            'ğŸ‡©ğŸ‡²': '[å¤šç±³å°¼å…‹]', 'ğŸ‡©ğŸ‡´': '[å¤šæ˜å°¼åŠ ]', 'ğŸ‡©ğŸ‡¿': '[é˜¿çˆ¾åŠåˆ©äº]', 'ğŸ‡ªğŸ‡¦': '[ä¼‘é”èˆ‡æ¢…åˆ©åˆ©äº]',
            'ğŸ‡ªğŸ‡¨': '[å„ç“œå¤š]', 'ğŸ‡ªğŸ‡ª': '[æ„›æ²™å°¼äº]', 'ğŸ‡ªğŸ‡¬': '[åŸƒåŠ]', 'ğŸ‡ªğŸ‡­': '[è¥¿æ’’å“ˆæ‹‰]',
            'ğŸ‡ªğŸ‡·': '[å„åˆ©å‚äº]', 'ğŸ‡ªğŸ‡¸': '[è¥¿ç­ç‰™]', 'ğŸ‡ªğŸ‡¹': '[è¡£ç´¢æ¯”äº]', 'ğŸ‡ªğŸ‡º': '[æ­ç›Ÿ]',
            'ğŸ‡«ğŸ‡®': '[èŠ¬è˜­]', 'ğŸ‡«ğŸ‡¯': '[æ–æ¿Ÿ]', 'ğŸ‡«ğŸ‡°': '[ç¦å…‹è˜­ç¾¤å³¶]', 'ğŸ‡«ğŸ‡²': '[å¯†å…‹ç¾…å°¼è¥¿äº]',
            'ğŸ‡«ğŸ‡´': '[æ³•ç¾…ç¾¤å³¶]', 'ğŸ‡«ğŸ‡·': '[æ³•åœ‹]', 'ğŸ‡¬ğŸ‡¦': '[åŠ å½­]', 'ğŸ‡¬ğŸ‡§': '[è‹±åœ‹]',
            'ğŸ‡¬ğŸ‡©': '[æ ¼ç‘é‚£é”]', 'ğŸ‡¬ğŸ‡ª': '[å–¬æ²»äº]', 'ğŸ‡¬ğŸ‡«': '[æ³•å±¬åœ­äºé‚£]', 'ğŸ‡¬ğŸ‡¬': '[æ ¹è¥¿å³¶]',
            'ğŸ‡¬ğŸ‡­': '[è¿¦ç´]', 'ğŸ‡¬ğŸ‡®': '[ç›´å¸ƒç¾…é™€]', 'ğŸ‡¬ğŸ‡±': '[æ ¼é™µè˜­]', 'ğŸ‡¬ğŸ‡²': '[ç”˜æ¯”äº]',
            'ğŸ‡¬ğŸ‡³': '[å¹¾å…§äº]', 'ğŸ‡¬ğŸ‡µ': '[ç“œå¾·ç¾…æ™®]', 'ğŸ‡¬ğŸ‡¶': '[èµ¤é“å¹¾å…§äº]', 'ğŸ‡¬ğŸ‡·': '[å¸Œè‡˜]',
            'ğŸ‡¬ğŸ‡¸': '[å—å–¬æ²»äºèˆ‡å—ä¸‰æ˜æ²»ç¾¤å³¶]', 'ğŸ‡¬ğŸ‡¹': '[ç“œåœ°é¦¬æ‹‰]', 'ğŸ‡¬ğŸ‡º': '[é—œå³¶]', 'ğŸ‡¬ğŸ‡¼': '[å¹¾å…§äºæ¯”ç´¢]',
            'ğŸ‡¬ğŸ‡¾': '[è“‹äºé‚£]', 'ğŸ‡­ğŸ‡°': '[é¦™æ¸¯]', 'ğŸ‡­ğŸ‡²': '[èµ«å¾·å³¶èˆ‡éº¥ç•¶å‹ç¾¤å³¶]', 'ğŸ‡­ğŸ‡³': '[å®éƒ½æ‹‰æ–¯]',
            'ğŸ‡­ğŸ‡·': '[å…‹ç¾…åŸƒè¥¿äº]', 'ğŸ‡­ğŸ‡¹': '[æµ·åœ°]', 'ğŸ‡­ğŸ‡º': '[åŒˆç‰™åˆ©]', 'ğŸ‡®ğŸ‡©': '[å°å°¼]',
            'ğŸ‡®ğŸ‡ª': '[æ„›çˆ¾è˜­]', 'ğŸ‡®ğŸ‡±': '[ä»¥è‰²åˆ—]', 'ğŸ‡®ğŸ‡²': '[æ›¼å³¶]', 'ğŸ‡®ğŸ‡³': '[å°åº¦]',
            'ğŸ‡®ğŸ‡´': '[è‹±å±¬å°åº¦æ´‹é ˜åœ°]', 'ğŸ‡®ğŸ‡¶': '[ä¼Šæ‹‰å…‹]', 'ğŸ‡®ğŸ‡·': '[ä¼Šæœ—]', 'ğŸ‡®ğŸ‡¸': '[å†°å³¶]',
            'ğŸ‡®ğŸ‡¹': '[ç¾©å¤§åˆ©]', 'ğŸ‡¯ğŸ‡ª': '[æ¾¤è¥¿å³¶]', 'ğŸ‡¯ğŸ‡²': '[ç‰™è²·åŠ ]', 'ğŸ‡¯ğŸ‡´': '[ç´„æ—¦]',
            'ğŸ‡¯ğŸ‡µ': '[æ—¥æœ¬]', 'ğŸ‡°ğŸ‡ª': '[è‚¯äº]', 'ğŸ‡°ğŸ‡¬': '[å‰çˆ¾å‰æ–¯]', 'ğŸ‡°ğŸ‡­': '[æŸ¬åŸ”å¯¨]',
            'ğŸ‡°ğŸ‡®': '[å‰é‡Œå·´æ–¯]', 'ğŸ‡°ğŸ‡²': '[è‘›æ‘©]', 'ğŸ‡°ğŸ‡³': '[è–å…‹é‡Œæ–¯å¤šç¦èˆ‡å°¼ç¶­æ–¯]', 'ğŸ‡°ğŸ‡µ': '[åŒ—éŸ“]',
            'ğŸ‡°ğŸ‡·': '[å—éŸ“]', 'ğŸ‡°ğŸ‡¼': '[ç§‘å¨ç‰¹]', 'ğŸ‡°ğŸ‡¾': '[é–‹æ›¼ç¾¤å³¶]', 'ğŸ‡°ğŸ‡¿': '[å“ˆè–©å…‹]',
            'ğŸ‡±ğŸ‡¦': '[å¯®åœ‹]', 'ğŸ‡±ğŸ‡§': '[é»å·´å«©]', 'ğŸ‡±ğŸ‡¨': '[è–éœ²è¥¿äº]', 'ğŸ‡±ğŸ‡®': '[åˆ—æ”¯æ•¦æ–¯ç™»]',
            'ğŸ‡±ğŸ‡°': '[æ–¯é‡Œè˜­å¡]', 'ğŸ‡±ğŸ‡·': '[è³´æ¯”ç‘äº]', 'ğŸ‡±ğŸ‡¸': '[è³´ç´¢æ‰˜]', 'ğŸ‡±ğŸ‡¹': '[ç«‹é™¶å®›]',
            'ğŸ‡±ğŸ‡º': '[ç›§æ£®å ¡]', 'ğŸ‡±ğŸ‡»': '[æ‹‰è„«ç¶­äº]', 'ğŸ‡±ğŸ‡¾': '[åˆ©æ¯”äº]', 'ğŸ‡²ğŸ‡¦': '[æ‘©æ´›å“¥]',
            'ğŸ‡²ğŸ‡¨': '[æ‘©ç´å“¥]', 'ğŸ‡²ğŸ‡©': '[æ‘©çˆ¾å¤šç“¦]', 'ğŸ‡²ğŸ‡ª': '[è’™ç‰¹å…§å“¥ç¾…]', 'ğŸ‡²ğŸ‡«': '[æ³•å±¬è–é¦¬ä¸]',
            'ğŸ‡²ğŸ‡¬': '[é¦¬é”åŠ æ–¯åŠ ]', 'ğŸ‡²ğŸ‡­': '[é¦¬ç´¹çˆ¾ç¾¤å³¶]', 'ğŸ‡²ğŸ‡°': '[åŒ—é¦¬å…¶é “]', 'ğŸ‡²ğŸ‡±': '[é¦¬åˆ©]',
            'ğŸ‡²ğŸ‡²': '[ç·¬ç”¸]', 'ğŸ‡²ğŸ‡³': '[è’™å¤]', 'ğŸ‡²ğŸ‡´': '[æ¾³é–€]', 'ğŸ‡²ğŸ‡µ': '[åŒ—é¦¬é‡Œäºç´ç¾¤å³¶]',
            'ğŸ‡²ğŸ‡¶': '[é¦¬ä¸å°¼å…‹]', 'ğŸ‡²ğŸ‡·': '[èŒ…åˆ©å¡”å°¼äº]', 'ğŸ‡²ğŸ‡¸': '[è’™ç‰¹å¡æ‹‰ç‰¹]', 'ğŸ‡²ğŸ‡¹': '[é¦¬çˆ¾ä»–]',
            'ğŸ‡²ğŸ‡º': '[æ¨¡é‡Œè¥¿æ–¯]', 'ğŸ‡²ğŸ‡»': '[é¦¬çˆ¾åœ°å¤«]', 'ğŸ‡²ğŸ‡¼': '[é¦¬æ‹‰å¨]', 'ğŸ‡²ğŸ‡½': '[å¢¨è¥¿å“¥]',
            'ğŸ‡²ğŸ‡¾': '[é¦¬ä¾†è¥¿äº]', 'ğŸ‡²ğŸ‡¿': '[è«ä¸‰æ¯”å…‹]', 'ğŸ‡³ğŸ‡¦': '[ç´ç±³æ¯”äº]', 'ğŸ‡³ğŸ‡¨': '[æ–°å–€é‡Œå¤šå°¼äº]',
            'ğŸ‡³ğŸ‡ª': '[å°¼æ—¥]', 'ğŸ‡³ğŸ‡«': '[è«¾ç¦å…‹å³¶]', 'ğŸ‡³ğŸ‡¬': '[å¥ˆåŠåˆ©äº]', 'ğŸ‡³ğŸ‡®': '[å°¼åŠ æ‹‰ç“œ]',
            'ğŸ‡³ğŸ‡±': '[è·è˜­]', 'ğŸ‡³ğŸ‡´': '[æŒªå¨]', 'ğŸ‡³ğŸ‡µ': '[å°¼æ³Šçˆ¾]', 'ğŸ‡³ğŸ‡·': '[è«¾é­¯]',
            'ğŸ‡³ğŸ‡º': '[ç´åŸƒ]', 'ğŸ‡³ğŸ‡¿': '[ç´è¥¿è˜­]', 'ğŸ‡´ğŸ‡²': '[é˜¿æ›¼]', 'ğŸ‡µğŸ‡¦': '[å·´æ‹¿é¦¬]',
            'ğŸ‡µğŸ‡ª': '[ç§˜é­¯]', 'ğŸ‡µğŸ‡«': '[æ³•å±¬ç»é‡Œå°¼è¥¿äº]', 'ğŸ‡µğŸ‡¬': '[å·´å¸ƒäºç´å¹¾å…§äº]', 'ğŸ‡µğŸ‡­': '[è²å¾‹è³“]',
            'ğŸ‡µğŸ‡°': '[å·´åŸºæ–¯å¦]', 'ğŸ‡µğŸ‡±': '[æ³¢è˜­]', 'ğŸ‡µğŸ‡²': '[è–çš®åŸƒèˆ‡å¯†å…‹éš†ç¾¤å³¶]', 'ğŸ‡µğŸ‡³': '[çš®ç‰¹è‚¯ç¾¤å³¶]',
            'ğŸ‡µğŸ‡·': '[æ³¢å¤šé»å„]', 'ğŸ‡µğŸ‡¸': '[å·´å‹’æ–¯å¦]', 'ğŸ‡µğŸ‡¹': '[è‘¡è„ç‰™]', 'ğŸ‡µğŸ‡¼': '[å¸›ç‰]',
            'ğŸ‡µğŸ‡¾': '[å·´æ‹‰åœ­]', 'ğŸ‡¶ğŸ‡¦': '[å¡é”]', 'ğŸ‡·ğŸ‡ª': '[ç•™å°¼æ—º]', 'ğŸ‡·ğŸ‡´': '[ç¾…é¦¬å°¼äº]',
            'ğŸ‡·ğŸ‡¸': '[å¡çˆ¾ç¶­äº]', 'ğŸ‡·ğŸ‡º': '[ä¿„ç¾…æ–¯]', 'ğŸ‡·ğŸ‡¼': '[ç›§å®‰é”]', 'ğŸ‡¸ğŸ‡¦': '[æ²™çƒåœ°é˜¿æ‹‰ä¼¯]',
            'ğŸ‡¸ğŸ‡§': '[æ‰€ç¾…é–€ç¾¤å³¶]', 'ğŸ‡¸ğŸ‡¨': '[å¡å¸­çˆ¾]', 'ğŸ‡¸ğŸ‡©': '[è˜‡ä¸¹]', 'ğŸ‡¸ğŸ‡ª': '[ç‘å…¸]',
            'ğŸ‡¸ğŸ‡¬': '[æ–°åŠ å¡]', 'ğŸ‡¸ğŸ‡­': '[è–èµ«å‹’æ‹¿]', 'ğŸ‡¸ğŸ‡®': '[æ–¯æ´›ç¶­å°¼äº]', 'ğŸ‡¸ğŸ‡¯': '[æ–¯ç“¦çˆ¾å·´èˆ‡æšé¦¬å»¶]',
            'ğŸ‡¸ğŸ‡°': '[æ–¯æ´›ä¼å…‹]', 'ğŸ‡¸ğŸ‡±': '[ç…å­å±±]', 'ğŸ‡¸ğŸ‡²': '[è–é¦¬åˆ©è«¾]', 'ğŸ‡¸ğŸ‡³': '[å¡å…§åŠ çˆ¾]',
            'ğŸ‡¸ğŸ‡´': '[ç´¢é¦¬åˆ©äº]', 'ğŸ‡¸ğŸ‡·': '[è˜‡åˆ©å—]', 'ğŸ‡¸ğŸ‡¸': '[å—è˜‡ä¸¹]', 'ğŸ‡¸ğŸ‡¹': '[è–å¤šç¾èˆ‡æ™®æ—è¥¿æ¯”]',
            'ğŸ‡¸ğŸ‡»': '[è–©çˆ¾ç“¦å¤š]', 'ğŸ‡¸ğŸ‡½': '[è·å±¬è–é¦¬ä¸]', 'ğŸ‡¸ğŸ‡¾': '[æ•˜åˆ©äº]', 'ğŸ‡¸ğŸ‡¿': '[å²ç“¦å¸å°¼]',
            'ğŸ‡¹ğŸ‡¦': '[ç‰¹é‡Œæ–¯å¦é”åº«å°¼äº]', 'ğŸ‡¹ğŸ‡¨': '[åœŸå…‹å‡±å¯ç¾¤å³¶]', 'ğŸ‡¹ğŸ‡©': '[æŸ¥å¾·]', 'ğŸ‡¹ğŸ‡«': '[æ³•å±¬å—éƒ¨é ˜åœ°]',
            'ğŸ‡¹ğŸ‡¬': '[å¤šå“¥]', 'ğŸ‡¹ğŸ‡­': '[æ³°åœ‹]', 'ğŸ‡¹ğŸ‡¯': '[å¡”å‰å…‹]', 'ğŸ‡¹ğŸ‡°': '[æ‰˜å…‹å‹]',
            'ğŸ‡¹ğŸ‡±': '[æ±å¸æ±¶]', 'ğŸ‡¹ğŸ‡²': '[åœŸåº«æ›¼]', 'ğŸ‡¹ğŸ‡³': '[çªå°¼è¥¿äº]', 'ğŸ‡¹ğŸ‡´': '[æ±åŠ ]',
            'ğŸ‡¹ğŸ‡·': '[åœŸè€³å…¶]', 'ğŸ‡¹ğŸ‡¹': '[ç‰¹ç«‹å°¼é”èˆ‡å¤šå·´å“¥]', 'ğŸ‡¹ğŸ‡»': '[åœ–ç“¦ç›§]', 'ğŸ‡¹ğŸ‡¼': '[å°ç£]',
            'ğŸ‡¹ğŸ‡¿': '[å¦å°šå°¼äº]', 'ğŸ‡ºğŸ‡¦': '[çƒå…‹è˜­]', 'ğŸ‡ºğŸ‡¬': '[çƒå¹²é”]', 'ğŸ‡ºğŸ‡²': '[ç¾åœ‹æœ¬åœŸå¤–å°å³¶å¶¼]',
            'ğŸ‡ºğŸ‡³': '[è¯åˆåœ‹]', 'ğŸ‡ºğŸ‡¸': '[ç¾åœ‹]', 'ğŸ‡ºğŸ‡¾': '[çƒæ‹‰åœ­]', 'ğŸ‡ºğŸ‡¿': '[çƒèŒ²åˆ¥å…‹]',
            'ğŸ‡»ğŸ‡¦': '[æ¢µè’‚å²¡]', 'ğŸ‡»ğŸ‡¨': '[è–æ–‡æ£®ç‰¹èˆ‡æ ¼ç‘é‚£ä¸æ–¯]', 'ğŸ‡»ğŸ‡ª': '[å§”å…§ç‘æ‹‰]', 'ğŸ‡»ğŸ‡¬': '[è‹±å±¬ç¶­äº¬ç¾¤å³¶]',
            'ğŸ‡»ğŸ‡®': '[ç¾å±¬ç¶­äº¬ç¾¤å³¶]', 'ğŸ‡»ğŸ‡³': '[è¶Šå—]', 'ğŸ‡»ğŸ‡º': '[è¬é‚£æœ]', 'ğŸ‡¼ğŸ‡«': '[ç“¦åˆ©æ–¯èˆ‡å¯Œåœ–ç´]',
            'ğŸ‡¼ğŸ‡¸': '[è–©æ‘©äº]', 'ğŸ‡¾ğŸ‡ª': '[è‘‰é–€]', 'ğŸ‡¾ğŸ‡¹': '[é¦¬ç´„ç‰¹]', 'ğŸ‡¿ğŸ‡¦': '[å—é]',
            'ğŸ‡¿ğŸ‡²': '[å°šæ¯”äº]', 'ğŸ‡¿ğŸ‡¼': '[è¾›å·´å¨]', 'ğŸ´ó §ó ¢ó ¥ó ®ó §ó ¿': '[è‹±æ ¼è˜­]', 'ğŸ´ó §ó ¢ó ³ó £ó ´ó ¿': '[è˜‡æ ¼è˜­]',
            'ğŸ´ó §ó ¢ó ·ó ¬ó ³ó ¿': '[å¨çˆ¾æ–¯]'
        }
        
        # ç‰¹æ®Šå­—ç¬¦æ˜ å°„
        self.special_char_mapping = {
            'Â®': '[è¨»å†Šå•†æ¨™]', 'Â©': '[ç‰ˆæ¬Š]', 'â„¢': '[å•†æ¨™]', 'â„ ': '[æœå‹™å•†æ¨™]',
            'â„—': '[éŒ„éŸ³ç‰ˆæ¬Š]', 'â„…': '[è½‰äº¤]', 'â„–': '[ç·¨è™Ÿ]', 'â„¡': '[é›»è©±]',
            'â„': '[è™•æ–¹]', 'â„Ÿ': '[å›æ‡‰]', 'â„ ': '[æœå‹™å•†æ¨™]', 'â„¢': '[å•†æ¨™]',
            'â„ƒ': '[æ”æ°åº¦]', 'â„‰': '[è¯æ°åº¦]', 'Â°': '[åº¦]', 'â€²': '[åˆ†]',
            'â€³': '[ç§’]', 'â€°': '[åƒåˆ†æ¯”]', 'â€±': '[è¬åˆ†æ¯”]', 'âˆ': '[ç„¡é™]',
            'âˆ…': '[ç©ºé›†]', 'âˆˆ': '[å±¬æ–¼]', 'âˆ‰': '[ä¸å±¬æ–¼]', 'âˆ‹': '[åŒ…å«]',
            'âˆŒ': '[ä¸åŒ…å«]', 'âˆ': '[é€£ä¹˜]', 'âˆ‘': '[é€£åŠ ]', 'âˆš': '[æ ¹è™Ÿ]',
            'âˆ›': '[ç«‹æ–¹æ ¹]', 'âˆœ': '[å››æ¬¡æ ¹]', 'Â±': '[æ­£è² ]', 'âˆ“': '[è² æ­£]',
            'Ã—': '[ä¹˜]', 'Ã·': '[é™¤]', 'âˆ•': '[åˆ†æ•¸ç·š]', 'âˆ—': '[æ˜Ÿè™Ÿ]',
            'âˆ˜': '[è¤‡åˆ]', 'âˆ™': '[é»ä¹˜]', 'â‹…': '[é»]', 'â‹†': '[æ˜Ÿè™Ÿ]',
            'â‹‡': '[é™¤è™Ÿ]', 'â‹ˆ': '[é€£æ¥]', 'â‹‰': '[å·¦é€£æ¥]', 'â‹Š': '[å³é€£æ¥]',
            'â‹‹': '[å·¦åé€£æ¥]', 'â‹Œ': '[å³åé€£æ¥]', 'â‹': '[ç›¸ä¼¼]', 'â‹': '[æˆ–]',
            'â‹': '[ä¸”]', 'â‹': '[åŒ…å«æ–¼]', 'â‹‘': '[åŒ…å«]', 'â‹’': '[äº¤é›†]',
            'â‹“': '[è¯é›†]', 'â‹”': '[å‚ç›´]', 'â‹•': '[å¹³è¡Œ]', 'â‹–': '[å°æ–¼]',
            'â‹—': '[å¤§æ–¼]', 'â‹˜': '[é å°æ–¼]', 'â‹™': '[é å¤§æ–¼]', 'â‹š': '[å°æ–¼ç­‰æ–¼]',
            'â‹›': '[å¤§æ–¼ç­‰æ–¼]', 'â‹œ': '[ç­‰æ–¼]', 'â‹': '[ä¸ç­‰æ–¼]', 'â‹': '[å°æ–¼ç­‰æ–¼]',
            'â‹Ÿ': '[å¤§æ–¼ç­‰æ–¼]', 'â‹ ': '[ä¸å°æ–¼]', 'â‹¡': '[ä¸å¤§æ–¼]', 'â‹¢': '[ä¸åŒ…å«æ–¼]',
            'â‹£': '[ä¸åŒ…å«]', 'â‹¤': '[ä¸åŒ…å«æ–¼]', 'â‹¥': '[ä¸åŒ…å«]', 'â‹¦': '[å°æ–¼]',
            'â‹§': '[å¤§æ–¼]', 'â‹¨': '[å°æ–¼]', 'â‹©': '[å¤§æ–¼]', 'â‹ª': '[ä¸åŒ…å«æ–¼]',
            'â‹«': '[ä¸åŒ…å«]', 'â‹¬': '[ä¸åŒ…å«æ–¼]', 'â‹­': '[ä¸åŒ…å«]', 'â‹®': '[å‚ç›´çœç•¥]',
            'â‹¯': '[æ°´å¹³çœç•¥]', 'â‹°': '[å·¦ä¸Šçœç•¥]', 'â‹±': '[å³ä¸‹çœç•¥]', 'â‹²': '[åŒ…å«æ–¼]',
            'â‹³': '[åŒ…å«]', 'â‹´': '[åŒ…å«æ–¼]', 'â‹µ': '[åŒ…å«]', 'â‹¶': '[åŒ…å«æ–¼]',
            'â‹·': '[åŒ…å«]', 'â‹¸': '[åŒ…å«æ–¼]', 'â‹¹': '[åŒ…å«]', 'â‹º': '[åŒ…å«æ–¼]',
            'â‹»': '[åŒ…å«]', 'â‹¼': '[åŒ…å«æ–¼]', 'â‹½': '[åŒ…å«]', 'â‹¾': '[åŒ…å«æ–¼]',
            'â‹¿': '[åŒ…å«]'
        }
    
    def clean_text(self, text: str, remove_emojis: bool = True, 
                   normalize_unicode: bool = True, 
                   remove_special_chars: bool = False) -> str:
        """
        æ¸…ç†æ–‡æœ¬
        
        Args:
            text: åŸå§‹æ–‡æœ¬
            remove_emojis: æ˜¯å¦ç§»é™¤è¡¨æƒ…ç¬¦è™Ÿ
            normalize_unicode: æ˜¯å¦æ¨™æº–åŒ– Unicode
            remove_special_chars: æ˜¯å¦ç§»é™¤ç‰¹æ®Šå­—ç¬¦
            
        Returns:
            æ¸…ç†å¾Œçš„æ–‡æœ¬
        """
        if not text:
            return ""
        
        cleaned_text = text
        
        # 1. Unicode æ¨™æº–åŒ–
        if normalize_unicode:
            cleaned_text = unicodedata.normalize('NFKC', cleaned_text)
        
        # 2. è™•ç†è¡¨æƒ…ç¬¦è™Ÿ
        if remove_emojis:
            cleaned_text = self._replace_emojis(cleaned_text)
        
        # 3. è™•ç†ç‰¹æ®Šå­—ç¬¦
        if remove_special_chars:
            cleaned_text = self._replace_special_chars(cleaned_text)
        
        # 4. ç§»é™¤å¤šé¤˜ç©ºç™½
        cleaned_text = re.sub(r'\s+', ' ', cleaned_text).strip()
        
        return cleaned_text
    
    def _replace_emojis(self, text: str) -> str:
        """æ›¿æ›è¡¨æƒ…ç¬¦è™Ÿ"""
        for emoji, replacement in self.emoji_mapping.items():
            text = text.replace(emoji, replacement)
        
        # ç§»é™¤å…¶ä»–è¡¨æƒ…ç¬¦è™Ÿï¼ˆä½¿ç”¨æ­£å‰‡è¡¨é”å¼ï¼‰
        text = re.sub(r'[\U0001F600-\U0001F64F]', '[è¡¨æƒ…]', text)  # è¡¨æƒ…
        text = re.sub(r'[\U0001F300-\U0001F5FF]', '[ç¬¦è™Ÿ]', text)  # ç¬¦è™Ÿ
        text = re.sub(r'[\U0001F680-\U0001F6FF]', '[äº¤é€š]', text)  # äº¤é€š
        text = re.sub(r'[\U0001F1E0-\U0001F1FF]', '[åœ‹æ——]', text)  # åœ‹æ——
        text = re.sub(r'[\U00002600-\U000027BF]', '[ç¬¦è™Ÿ]', text)  # ç¬¦è™Ÿ
        text = re.sub(r'[\U0001F900-\U0001F9FF]', '[ç¬¦è™Ÿ]', text)  # ç¬¦è™Ÿ
        
        return text
    
    def _replace_special_chars(self, text: str) -> str:
        """æ›¿æ›ç‰¹æ®Šå­—ç¬¦"""
        for char, replacement in self.special_char_mapping.items():
            text = text.replace(char, replacement)
        
        return text
    
    def normalize_title(self, title: str) -> str:
        """
        æ¨™æº–åŒ–æ¨™é¡Œï¼Œç”¨æ–¼è³‡æ–™åº«åŒ¹é…
        
        Args:
            title: åŸå§‹æ¨™é¡Œ
            
        Returns:
            æ¨™æº–åŒ–å¾Œçš„æ¨™é¡Œ
        """
        if not title:
            return ""
        
        # 1. åŸºæœ¬æ¸…ç†
        normalized = self.clean_text(title, remove_emojis=True, normalize_unicode=True)
        
        # 2. ç§»é™¤æ¨™é»ç¬¦è™Ÿï¼ˆä¿ç•™ä¸­æ–‡æ¨™é»ï¼‰
        normalized = re.sub(r'[^\u4e00-\u9fff\w\s]', '', normalized)
        
        # 3. è½‰æ›ç‚ºå°å¯«
        normalized = normalized.lower()
        
        # 4. ç§»é™¤å¤šé¤˜ç©ºç™½
        normalized = re.sub(r'\s+', ' ', normalized).strip()
        
        return normalized
    
    def create_search_variants(self, title: str) -> List[str]:
        """
        å‰µå»ºæ¨™é¡Œçš„æœå°‹è®Šé«”
        
        Args:
            title: åŸå§‹æ¨™é¡Œ
            
        Returns:
            æœå°‹è®Šé«”åˆ—è¡¨
        """
        variants = []
        
        if not title:
            return variants
        
        # 1. åŸå§‹æ¨™é¡Œ
        variants.append(title)
        
        # 2. æ¸…ç†å¾Œçš„æ¨™é¡Œ
        cleaned = self.clean_text(title, remove_emojis=True, normalize_unicode=True)
        if cleaned != title:
            variants.append(cleaned)
        
        # 3. æ¨™æº–åŒ–æ¨™é¡Œ
        normalized = self.normalize_title(title)
        if normalized != title and normalized not in variants:
            variants.append(normalized)
        
        # 4. ç§»é™¤è¡¨æƒ…ç¬¦è™Ÿä½†ä¿ç•™å…¶ä»–å­—ç¬¦
        emoji_removed = self.clean_text(title, remove_emojis=True, normalize_unicode=False, remove_special_chars=False)
        if emoji_removed != title and emoji_removed not in variants:
            variants.append(emoji_removed)
        
        # 5. åªç§»é™¤ç‰¹æ®Šå­—ç¬¦
        special_removed = self.clean_text(title, remove_emojis=False, normalize_unicode=False, remove_special_chars=True)
        if special_removed != title and special_removed not in variants:
            variants.append(special_removed)
        
        return list(set(variants))  # å»é‡
    
    def is_similar_title(self, title1: str, title2: str, threshold: float = 0.8) -> bool:
        """
        æª¢æŸ¥å…©å€‹æ¨™é¡Œæ˜¯å¦ç›¸ä¼¼
        
        Args:
            title1: æ¨™é¡Œ1
            title2: æ¨™é¡Œ2
            threshold: ç›¸ä¼¼åº¦é–¾å€¼
            
        Returns:
            æ˜¯å¦ç›¸ä¼¼
        """
        if not title1 or not title2:
            return False
        
        # æ¨™æº–åŒ–å…©å€‹æ¨™é¡Œ
        norm1 = self.normalize_title(title1)
        norm2 = self.normalize_title(title2)
        
        # å®Œå…¨åŒ¹é…
        if norm1 == norm2:
            return True
        
        # è¨ˆç®—ç›¸ä¼¼åº¦ï¼ˆç°¡å–®çš„å­—ç¬¦é‡ç–Šç‡ï¼‰
        if len(norm1) > 0 and len(norm2) > 0:
            common_chars = set(norm1) & set(norm2)
            total_chars = set(norm1) | set(norm2)
            similarity = len(common_chars) / len(total_chars)
            return similarity >= threshold
        
        return False 