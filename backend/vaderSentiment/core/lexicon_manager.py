#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
詞典管理器

統一管理正面、負面、程度詞、否定詞等情感詞典
"""

from typing import Dict, Set


class LexiconManager:
    """詞典管理器"""
    
    def __init__(self):
        """初始化詞典"""
        self.positive_words = self._load_positive_words()
        self.negative_words = self._load_negative_words()
        self.intensifiers = self._load_intensifiers()
        self.negations = self._load_negations()
    
    def _load_positive_words(self) -> Set[str]:
        """載入正面詞彙"""
        return {
            '好', '棒', '讚', '優秀', '完美', '喜歡', '愛', '開心', '快樂', '高興', 
            '興奮', '滿意', '成功', '厲害', '強大', '美好', '精彩', '有趣', '好玩',
            '舒適', '方便', '快速', '便宜', '划算', '值得', '推薦', '支持', '鼓勵',
            '幫助', '溫暖', '友善', '親切', '專業', '認真', '負責', '誠實', '可靠',
            '穩定', '安全', '健康', '新鮮', '美味', '漂亮', '帥氣', '可愛', '聰明',
            '智慧', '創意', '創新', '進步', '發展', '成長', '學習', '提升', '改善',
            '解決', '完成', '實現', '夢想', '希望', '未來', '機會', '成功', '勝利',
            '冠軍', '第一', '最好', '最棒', '最讚', '超棒', '超讚', '無敵', '完美',
            '理想', '優質', '高品質', '頂級', '一流', '傑出', '卓越', '非凡', '出色',
            '優雅', '精緻', '細緻', '用心', '貼心', '周到', '細心', '耐心', '恆心',
            '決心', '信心', '勇氣', '堅強', '勇敢', '樂觀', '積極', '正面', '陽光',
            '活力', '能量', '動力', '熱情', '激情', '熱愛', '熱衷', '專注', '投入',
            '專心', '專注', '專一', '專精', '精通', '熟練', '熟練', '熟練', '熟練',
            # 從停用詞中移出的正面詞彙
            '知道', '覺得', '認為', '想', '感覺', '期待', '可以', '應該', '需要', '想要',
            '乾淨', '整齊', '簡單', '容易', '免費', '公開', '正式', '重要', '緊急', '安全',
            '現代', '自由', '平等', '公平', '正義', '民主', '和平', '合作', '團結'
        }
    
    def _load_negative_words(self) -> Set[str]:
        """載入負面詞彙 - 已清理重複詞彙"""
        return {
            # 基礎負面情感詞彙
            '壞', '糟', '爛', '差', '討厭', '恨', '生氣', '憤怒', '傷心', '難過',
            '痛苦', '失望', '失敗', '無聊', '煩', '累', '疲憊', '困難', '麻煩',
            '複雜', '昂貴', '貴', '浪費', '不值得', '不推薦', '反對', '批評',
            '抱怨', '指責', '冷漠', '無情', '不友善', '不專業', '不認真', '不負責',
            '不誠實', '不可靠', '不穩定', '不安全', '不健康', '不新鮮', '難吃',
            '醜', '難看', '笨', '愚蠢', '無創意', '退步', '退縮', '停滯',
            '問題', '障礙', '挫折', '絕望', '無望', '失去', '錯過', '輸',
            '單調', '枯燥', '乏味', '沉悶', '壓抑', '沉重', '折磨', '煎熬',
            '恐懼', '害怕', '驚恐', '恐慌',
            
            # 品質相關負面詞彙
            '不公平', '不正義', '不舒服', '髒', '亂', '邪惡', '說謊', 
            '膽小', '軟弱', '悲觀', '消極', '被動', '依賴', '不平等', '專制', 
            '戰爭', '分裂', '守舊', '吵', '危險', '傳統', '保守', '限制', '競爭',
            
            # 否定詞組合（避免重複）
            '不喜歡', '不愛', '不開心', '不高興', '不快樂', '不滿意', '不成功',
            '不厲害', '不強大', '不美好', '不精彩', '不有趣', '不好玩', '不舒適',
            '不方便', '不快速', '不便宜', '不划算', '不支持', '不鼓勵', '不幫助',
            '不溫暖', '不親切', '不美味', '不漂亮', '不帥氣', '不可愛', '不聰明',
            '不智慧', '不能', '不需要', '不想要', '不知道', '擔心', '不累', '不餓', '不渴'
        }
    
    def _load_intensifiers(self) -> Dict[str, float]:
        """載入程度詞"""
        return {
            '非常': 2.0, '很': 1.5, '特別': 1.8, '極其': 2.0, '十分': 1.8,
            '相當': 1.3, '比較': 1.2, '有點': 0.8, '稍微': 0.6, '一點': 0.5,
            '超級': 2.5, '無敵': 2.5, '超': 1.8, '太': 1.5, '真': 1.3,
            '確實': 1.2, '真的': 1.3, '實在': 1.2, '簡直': 1.5, '完全': 1.8,
            '絕對': 2.0, '根本': 1.5, '從來': 1.3, '從來沒有': 1.5, '從來不': 1.5,
            # 從停用詞中移出的程度詞
            '熱': 1.2, '冷': 1.2, '暖': 1.1, '涼': 1.1, '亮': 1.1, '暗': 1.2,
            '安靜': 1.1, '吵': 1.3, '整齊': 1.1, '亂': 1.3, '簡單': 1.1, '複雜': 1.3,
            '容易': 1.1, '困難': 1.3, '便宜': 1.1, '貴': 1.3, '免費': 1.1, '付費': 1.2,
            '公開': 1.1, '私人': 1.1, '正式': 1.1, '非正式': 1.1, '重要': 1.2,
            '不重要': 1.2, '緊急': 1.3, '不緊急': 1.1, '危險': 1.5, '安全': 1.1
        }
    
    def _load_negations(self) -> Set[str]:
        """載入否定詞"""
        return {
            '不', '沒', '無', '別', '莫', '勿', '未', '非', '否', '不是',
            '沒有', '無關', '無所謂', '不在乎', '不關心', '不喜歡', '不愛',
            '不開心', '不快樂', '不高興', '不滿意', '不成功', '不厲害',
            '不強大', '不美好', '不精彩', '不有趣', '不好玩', '不舒適',
            '不方便', '不快速', '不便宜', '不划算', '不值得', '不推薦',
            '不支持', '不鼓勵', '不幫助', '不溫暖', '不友善', '不親切',
            '不專業', '不認真', '不負責', '不誠實', '不可靠', '不穩定',
            '不安全', '不健康', '不新鮮', '不美味', '不漂亮', '不帥氣',
            '不可愛', '不聰明', '不智慧', '不創意', '不創新', '不退步',
            '不退縮', '不停滯', '沒問題', '沒困難', '沒障礙', '沒失敗',
            '沒挫折', '沒絕望', '沒無望', '沒過去', '沒失去', '沒錯過',
            '沒失敗', '沒輸', '沒最後', '沒最差', '沒最糟', '沒最爛'
        }
    
    def get_positive_words(self) -> Set[str]:
        """獲取正面詞彙"""
        return self.positive_words.copy()
    
    def get_negative_words(self) -> Set[str]:
        """獲取負面詞彙"""
        return self.negative_words.copy()
    
    def get_intensifiers(self) -> Dict[str, float]:
        """獲取程度詞"""
        return self.intensifiers.copy()
    
    def get_negations(self) -> Set[str]:
        """獲取否定詞"""
        return self.negations.copy()
    
    def add_positive_words(self, words: Set[str]) -> None:
        """添加正面詞彙"""
        self.positive_words.update(words)
    
    def add_negative_words(self, words: Set[str]) -> None:
        """添加負面詞彙"""
        self.negative_words.update(words)
    
    def remove_positive_words(self, words: Set[str]) -> None:
        """移除正面詞彙"""
        self.positive_words.difference_update(words)
    
    def remove_negative_words(self, words: Set[str]) -> None:
        """移除負面詞彙"""
        self.negative_words.difference_update(words) 